<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>6.2 Positionnement multidimensionnel (MDS) | Science des données biologiques 2</title>
  <meta name="description" content="Tutoriel interactif pour la science des données avec R &amp; SciViews-R, partie 2.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="6.2 Positionnement multidimensionnel (MDS) | Science des données biologiques 2" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://biodatascience-course.sciviews.org/sdd-umons2-2019/" />
  <meta property="og:image" content="https://biodatascience-course.sciviews.org/sdd-umons2-2019/images/front-cover.png" />
  <meta property="og:description" content="Tutoriel interactif pour la science des données avec R &amp; SciViews-R, partie 2." />
  <meta name="github-repo" content="biodatascience-course/sdd-umons2-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.2 Positionnement multidimensionnel (MDS) | Science des données biologiques 2" />
  
  <meta name="twitter:description" content="Tutoriel interactif pour la science des données avec R &amp; SciViews-R, partie 2." />
  <meta name="twitter:image" content="https://biodatascience-course.sciviews.org/sdd-umons2-2019/images/front-cover.png" />

<meta name="author" content="Philippe Grosjean &amp; Guyliann Engels (avec des contributions de Raphaël Conotte)">


<meta name="date" content="2020-08-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="k-moyennes.html">
<link rel="next" href="cartes-auto-adaptatives-som.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<link href="libs/rglwidgetClass-2/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-2/rglClass.src.js"></script>
<script src="libs/CanvasMatrix4-2016/CanvasMatrix.src.js"></script>
<script src="libs/rglWebGL-binding-0.100.19/rglWebGL.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Science des données biologiques 2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préambule</a><ul>
<li class="chapter" data-level="" data-path="vue-generale-des-cours.html"><a href="vue-generale-des-cours.html"><i class="fa fa-check"></i>Vue générale des cours</a></li>
<li class="chapter" data-level="" data-path="materiel-pedagogique.html"><a href="materiel-pedagogique.html"><i class="fa fa-check"></i>Matériel pédagogique</a></li>
</ul></li>
<li class="part"><span><b>I Cours II: modélisation</b></span></li>
<li class="chapter" data-level="1" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>1</b> Régression linéaire I</a><ul>
<li class="chapter" data-level="1.1" data-path="modele.html"><a href="modele.html"><i class="fa fa-check"></i><b>1.1</b> Modèle</a><ul>
<li class="chapter" data-level="1.1.1" data-path="modele.html"><a href="modele.html#pourquoi-modeliser"><i class="fa fa-check"></i><b>1.1.1</b> Pourquoi modéliser ?</a></li>
<li class="chapter" data-level="1.1.2" data-path="modele.html"><a href="modele.html#quand-modeliser"><i class="fa fa-check"></i><b>1.1.2</b> Quand modéliser ?</a></li>
<li class="chapter" data-level="1.1.3" data-path="modele.html"><a href="modele.html#entrainement-et-confirmation"><i class="fa fa-check"></i><b>1.1.3</b> Entraînement et confirmation</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="regression-lineaire-simple.html"><a href="regression-lineaire-simple.html"><i class="fa fa-check"></i><b>1.2</b> Régression linéaire simple</a><ul>
<li class="chapter" data-level="1.2.1" data-path="regression-lineaire-simple.html"><a href="regression-lineaire-simple.html#quantifier-lajustement-dun-modele"><i class="fa fa-check"></i><b>1.2.1</b> Quantifier l’ajustement d’un modèle</a></li>
<li class="chapter" data-level="1.2.2" data-path="regression-lineaire-simple.html"><a href="regression-lineaire-simple.html#trouver-la-meilleure-droite"><i class="fa fa-check"></i><b>1.2.2</b> Trouver la meilleure droite</a></li>
<li class="chapter" data-level="1.2.3" data-path="regression-lineaire-simple.html"><a href="regression-lineaire-simple.html#la-fonction-lm"><i class="fa fa-check"></i><b>1.2.3</b> La fonction <code>lm()</code></a></li>
<li class="chapter" data-level="1.2.4" data-path="regression-lineaire-simple.html"><a href="regression-lineaire-simple.html#resume-avec-summary"><i class="fa fa-check"></i><b>1.2.4</b> Résumé avec <code>summary()</code></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="outils-de-diagnostic.html"><a href="outils-de-diagnostic.html"><i class="fa fa-check"></i><b>1.3</b> Outils de diagnostic</a><ul>
<li class="chapter" data-level="1.3.1" data-path="outils-de-diagnostic.html"><a href="outils-de-diagnostic.html#analyse-des-residus"><i class="fa fa-check"></i><b>1.3.1</b> Analyse des résidus</a></li>
<li class="chapter" data-level="1.3.2" data-path="outils-de-diagnostic.html"><a href="outils-de-diagnostic.html#enveloppe-de-confiance"><i class="fa fa-check"></i><b>1.3.2</b> Enveloppe de confiance</a></li>
<li class="chapter" data-level="1.3.3" data-path="outils-de-diagnostic.html"><a href="outils-de-diagnostic.html#extraire-les-donnees-dun-modele"><i class="fa fa-check"></i><b>1.3.3</b> Extraire les données d’un modèle</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lm2.html"><a href="lm2.html"><i class="fa fa-check"></i><b>2</b> Régression linéaire II</a><ul>
<li class="chapter" data-level="2.1" data-path="outils-de-diagnostic-suite.html"><a href="outils-de-diagnostic-suite.html"><i class="fa fa-check"></i><b>2.1</b> Outils de diagnostic (suite)</a><ul>
<li class="chapter" data-level="2.1.1" data-path="outils-de-diagnostic-suite.html"><a href="outils-de-diagnostic-suite.html#resume-avec-summarysuite"><i class="fa fa-check"></i><b>2.1.1</b> Résumé avec <code>summary()</code>(suite)</a></li>
<li class="chapter" data-level="2.1.2" data-path="outils-de-diagnostic-suite.html"><a href="outils-de-diagnostic-suite.html#comparaison-de-regressions"><i class="fa fa-check"></i><b>2.1.2</b> Comparaison de régressions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="regression-lineaire-multiple.html"><a href="regression-lineaire-multiple.html"><i class="fa fa-check"></i><b>2.2</b> Régression linéaire multiple</a></li>
<li class="chapter" data-level="2.3" data-path="regression-lineaire-polynomiale.html"><a href="regression-lineaire-polynomiale.html"><i class="fa fa-check"></i><b>2.3</b> Régression linéaire polynomiale</a></li>
<li class="chapter" data-level="2.4" data-path="rmse-critere-dakaike.html"><a href="rmse-critere-dakaike.html"><i class="fa fa-check"></i><b>2.4</b> RMSE &amp; critère d’Akaike</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-lineaire.html"><a href="mod-lineaire.html"><i class="fa fa-check"></i><b>3</b> Modèle linéaire</a><ul>
<li class="chapter" data-level="3.1" data-path="variables-numeriques-ou-facteurs.html"><a href="variables-numeriques-ou-facteurs.html"><i class="fa fa-check"></i><b>3.1</b> Variables numériques ou facteurs</a></li>
<li class="chapter" data-level="3.2" data-path="anova-et-regression-lineaire.html"><a href="anova-et-regression-lineaire.html"><i class="fa fa-check"></i><b>3.2</b> ANOVA et régression linéaire</a><ul>
<li class="chapter" data-level="3.2.1" data-path="anova-et-regression-lineaire.html"><a href="anova-et-regression-lineaire.html#modele-lineaire-commun"><i class="fa fa-check"></i><b>3.2.1</b> Modèle linéaire commun</a></li>
<li class="chapter" data-level="3.2.2" data-path="anova-et-regression-lineaire.html"><a href="anova-et-regression-lineaire.html#reencodage-des-variables-de-lanova"><i class="fa fa-check"></i><b>3.2.2</b> Réencodage des variables de l’ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="matrice-de-contraste.html"><a href="matrice-de-contraste.html"><i class="fa fa-check"></i><b>3.3</b> Matrice de contraste</a><ul>
<li class="chapter" data-level="3.3.1" data-path="matrice-de-contraste.html"><a href="matrice-de-contraste.html#contraste-orthogonaux"><i class="fa fa-check"></i><b>3.3.1</b> Contraste orthogonaux</a></li>
<li class="chapter" data-level="3.3.2" data-path="matrice-de-contraste.html"><a href="matrice-de-contraste.html#autres-matrices-de-contrastes-courantes"><i class="fa fa-check"></i><b>3.3.2</b> Autres matrices de contrastes courantes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ancova.html"><a href="ancova.html"><i class="fa fa-check"></i><b>3.4</b> ANCOVA</a><ul>
<li class="chapter" data-level="3.4.1" data-path="ancova.html"><a href="ancova.html#bebes-a-la-naissance"><i class="fa fa-check"></i><b>3.4.1</b> Bébés à la naissance</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="modele-lineaire-generalise.html"><a href="modele-lineaire-generalise.html"><i class="fa fa-check"></i><b>3.5</b> Modèle linéaire généralisé</a><ul>
<li class="chapter" data-level="3.5.1" data-path="modele-lineaire-generalise.html"><a href="modele-lineaire-generalise.html#exemple"><i class="fa fa-check"></i><b>3.5.1</b> Exemple</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reg-non-lin.html"><a href="reg-non-lin.html"><i class="fa fa-check"></i><b>4</b> Régression non linéaire</a><ul>
<li class="chapter" data-level="4.1" data-path="rendement-photosynthetique.html"><a href="rendement-photosynthetique.html"><i class="fa fa-check"></i><b>4.1</b> Rendement photosynthétique</a></li>
<li class="chapter" data-level="4.2" data-path="principe.html"><a href="principe.html"><i class="fa fa-check"></i><b>4.2</b> Principe</a><ul>
<li class="chapter" data-level="4.2.1" data-path="principe.html"><a href="principe.html#fonction-objective"><i class="fa fa-check"></i><b>4.2.1</b> Fonction objective</a></li>
<li class="chapter" data-level="4.2.2" data-path="principe.html"><a href="principe.html#calcul-iteratif"><i class="fa fa-check"></i><b>4.2.2</b> Calcul itératif</a></li>
<li class="chapter" data-level="4.2.3" data-path="principe.html"><a href="principe.html#pieges-et-difficultes"><i class="fa fa-check"></i><b>4.2.3</b> Pièges et difficultés</a></li>
<li class="chapter" data-level="4.2.4" data-path="principe.html"><a href="principe.html#modeles-selfstart-dans-r"><i class="fa fa-check"></i><b>4.2.4</b> Modèles ‘selfStart’ dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html"><i class="fa fa-check"></i><b>4.3</b> Modèles courants en biologie</a><ul>
<li class="chapter" data-level="4.3.1" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-de-michaelis-menten"><i class="fa fa-check"></i><b>4.3.1</b> Modèle de Michaelis-Menten</a></li>
<li class="chapter" data-level="4.3.2" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modeles-de-croissance"><i class="fa fa-check"></i><b>4.3.2</b> Modèles de croissance</a></li>
<li class="chapter" data-level="4.3.3" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#courbe-exponentielle"><i class="fa fa-check"></i><b>4.3.3</b> Courbe exponentielle</a></li>
<li class="chapter" data-level="4.3.4" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#courbe-logistique"><i class="fa fa-check"></i><b>4.3.4</b> Courbe logistique</a></li>
<li class="chapter" data-level="4.3.5" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-de-gompertz"><i class="fa fa-check"></i><b>4.3.5</b> Modèle de Gompertz</a></li>
<li class="chapter" data-level="4.3.6" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modeles-de-von-bertalanffy"><i class="fa fa-check"></i><b>4.3.6</b> Modèles de von Bertalanffy</a></li>
<li class="chapter" data-level="4.3.7" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-de-richards"><i class="fa fa-check"></i><b>4.3.7</b> Modèle de Richards</a></li>
<li class="chapter" data-level="4.3.8" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-de-weibull"><i class="fa fa-check"></i><b>4.3.8</b> Modèle de Weibull</a></li>
<li class="chapter" data-level="4.3.9" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-preece-baines-1"><i class="fa fa-check"></i><b>4.3.9</b> Modèle Preece-Baines 1</a></li>
<li class="chapter" data-level="4.3.10" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-de-tanaka"><i class="fa fa-check"></i><b>4.3.10</b> Modèle de Tanaka</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="choix-du-modele.html"><a href="choix-du-modele.html"><i class="fa fa-check"></i><b>4.4</b> Choix du modèle</a></li>
</ul></li>
<li class="part"><span><b>II Cours II: analyse</b></span></li>
<li class="chapter" data-level="5" data-path="hierarchique.html"><a href="hierarchique.html"><i class="fa fa-check"></i><b>5</b> Classification hiérarchique</a><ul>
<li class="chapter" data-level="5.1" data-path="analyse-de-donnees.html"><a href="analyse-de-donnees.html"><i class="fa fa-check"></i><b>5.1</b> Analyse de données</a></li>
<li class="chapter" data-level="5.2" data-path="distance-entre-individus.html"><a href="distance-entre-individus.html"><i class="fa fa-check"></i><b>5.2</b> Distance entre individus</a><ul>
<li class="chapter" data-level="5.2.1" data-path="distance-entre-individus.html"><a href="distance-entre-individus.html#matrice-de-distances"><i class="fa fa-check"></i><b>5.2.1</b> Matrice de distances</a></li>
<li class="chapter" data-level="5.2.2" data-path="distance-entre-individus.html"><a href="distance-entre-individus.html#indices-de-dissimilarite"><i class="fa fa-check"></i><b>5.2.2</b> Indices de (dis)similarité</a></li>
<li class="chapter" data-level="5.2.3" data-path="distance-entre-individus.html"><a href="distance-entre-individus.html#utilisation-des-indices"><i class="fa fa-check"></i><b>5.2.3</b> Utilisation des indices</a></li>
<li class="chapter" data-level="5.2.4" data-path="distance-entre-individus.html"><a href="distance-entre-individus.html#proprietes-des-indices"><i class="fa fa-check"></i><b>5.2.4</b> Propriétés des indices</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="regroupement-avec-cah.html"><a href="regroupement-avec-cah.html"><i class="fa fa-check"></i><b>5.3</b> Regroupement avec CAH</a><ul>
<li class="chapter" data-level="5.3.1" data-path="regroupement-avec-cah.html"><a href="regroupement-avec-cah.html#dendrogramme"><i class="fa fa-check"></i><b>5.3.1</b> Dendrogramme</a></li>
<li class="chapter" data-level="5.3.2" data-path="regroupement-avec-cah.html"><a href="regroupement-avec-cah.html#separer-les-groupes"><i class="fa fa-check"></i><b>5.3.2</b> Séparer les groupes</a></li>
<li class="chapter" data-level="5.3.3" data-path="regroupement-avec-cah.html"><a href="regroupement-avec-cah.html#etude-complete"><i class="fa fa-check"></i><b>5.3.3</b> Étude complète</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="k-moyenne-mds-som.html"><a href="k-moyenne-mds-som.html"><i class="fa fa-check"></i><b>6</b> K-moyenne, MDS &amp; SOM</a><ul>
<li class="chapter" data-level="6.1" data-path="k-moyennes.html"><a href="k-moyennes.html"><i class="fa fa-check"></i><b>6.1</b> K-moyennes</a><ul>
<li class="chapter" data-level="6.1.1" data-path="k-moyennes.html"><a href="k-moyennes.html#exemple-simple"><i class="fa fa-check"></i><b>6.1.1</b> Exemple simple</a></li>
<li class="chapter" data-level="6.1.2" data-path="k-moyennes.html"><a href="k-moyennes.html#classification-du-zooplancton"><i class="fa fa-check"></i><b>6.1.2</b> Classification du zooplancton</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="positionnement-multidimensionnel-mds.html"><a href="positionnement-multidimensionnel-mds.html"><i class="fa fa-check"></i><b>6.2</b> Positionnement multidimensionnel (MDS)</a><ul>
<li class="chapter" data-level="6.2.1" data-path="positionnement-multidimensionnel-mds.html"><a href="positionnement-multidimensionnel-mds.html#mds-simplifiee-sous-sciviewsr"><i class="fa fa-check"></i><b>6.2.1</b> MDS simplifiée sous SciViews::R</a></li>
<li class="chapter" data-level="6.2.2" data-path="positionnement-multidimensionnel-mds.html"><a href="positionnement-multidimensionnel-mds.html#mds-metrique-ou-pcoa"><i class="fa fa-check"></i><b>6.2.2</b> MDS métrique ou PCoA</a></li>
<li class="chapter" data-level="6.2.3" data-path="positionnement-multidimensionnel-mds.html"><a href="positionnement-multidimensionnel-mds.html#mds-non-metrique"><i class="fa fa-check"></i><b>6.2.3</b> MDS non métrique</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="cartes-auto-adaptatives-som.html"><a href="cartes-auto-adaptatives-som.html"><i class="fa fa-check"></i><b>6.3</b> Cartes auto-adaptatives (SOM)</a><ul>
<li class="chapter" data-level="6.3.1" data-path="cartes-auto-adaptatives-som.html"><a href="cartes-auto-adaptatives-som.html#som-sur-le-zooplancton"><i class="fa fa-check"></i><b>6.3.1</b> SOM sur le zooplancton</a></li>
<li class="chapter" data-level="6.3.2" data-path="cartes-auto-adaptatives-som.html"><a href="cartes-auto-adaptatives-som.html#interpretation-dun-som"><i class="fa fa-check"></i><b>6.3.2</b> Interprétation d’un SOM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="acp-afc.html"><a href="acp-afc.html"><i class="fa fa-check"></i><b>7</b> ACP &amp; AFC</a><ul>
<li class="chapter" data-level="7.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html"><i class="fa fa-check"></i><b>7.1</b> Analyse en composantes principales</a><ul>
<li class="chapter" data-level="7.1.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#acp-dans-sciviewsr"><i class="fa fa-check"></i><b>7.1.1</b> ACP dans SciViews::R</a></li>
<li class="chapter" data-level="7.1.2" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#indiens-diabetiques"><i class="fa fa-check"></i><b>7.1.2</b> Indiens diabétiques</a></li>
<li class="chapter" data-level="7.1.3" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#biometrie-doursin"><i class="fa fa-check"></i><b>7.1.3</b> Biométrie d’oursin</a></li>
<li class="chapter" data-level="7.1.4" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#visualisation-de-donnees-quantitatives"><i class="fa fa-check"></i><b>7.1.4</b> Visualisation de données quantitatives</a></li>
<li class="chapter" data-level="7.1.5" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#acp-mecanisme"><i class="fa fa-check"></i><b>7.1.5</b> ACP : mécanisme</a></li>
<li class="chapter" data-level="7.1.6" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#calcul-matriciel-acp"><i class="fa fa-check"></i><b>7.1.6</b> Calcul matriciel ACP</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="analyse-factorielle-des-correspondances.html"><a href="analyse-factorielle-des-correspondances.html"><i class="fa fa-check"></i><b>7.2</b> Analyse factorielle des correspondances</a><ul>
<li class="chapter" data-level="7.2.1" data-path="analyse-factorielle-des-correspondances.html"><a href="analyse-factorielle-des-correspondances.html#afc-dans-sciviewsr"><i class="fa fa-check"></i><b>7.2.1</b> AFC dans SciViews::R</a></li>
<li class="chapter" data-level="7.2.2" data-path="analyse-factorielle-des-correspondances.html"><a href="analyse-factorielle-des-correspondances.html#enquete-sur-la-science"><i class="fa fa-check"></i><b>7.2.2</b> Enquête sur la science</a></li>
<li class="chapter" data-level="7.2.3" data-path="analyse-factorielle-des-correspondances.html"><a href="analyse-factorielle-des-correspondances.html#des-acariens-sinon-rien"><i class="fa fa-check"></i><b>7.2.3</b> Des acariens sinon rien</a></li>
<li class="chapter" data-level="7.2.4" data-path="analyse-factorielle-des-correspondances.html"><a href="analyse-factorielle-des-correspondances.html#principe-de-lafc"><i class="fa fa-check"></i><b>7.2.4</b> Principe de l’AFC</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html"><i class="fa fa-check"></i><b>7.3</b> Accès aux bases de données</a><ul>
<li class="chapter" data-level="7.3.1" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#installation-de-sqlite"><i class="fa fa-check"></i><b>7.3.1</b> Installation de SQLite</a></li>
<li class="chapter" data-level="7.3.2" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#base-de-donnees-en-memoire"><i class="fa fa-check"></i><b>7.3.2</b> Base de données en mémoire</a></li>
<li class="chapter" data-level="7.3.3" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#base-de-donnees-dans-un-fichier"><i class="fa fa-check"></i><b>7.3.3</b> Base de données dans un fichier</a></li>
<li class="chapter" data-level="7.3.4" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#driver-odbc-dans-rstudio"><i class="fa fa-check"></i><b>7.3.4</b> Driver ODBC dans RStudio</a></li>
<li class="chapter" data-level="7.3.5" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#utilisation-de-db-browser"><i class="fa fa-check"></i><b>7.3.5</b> Utilisation de DB Browser</a></li>
<li class="chapter" data-level="7.3.6" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#utilisation-de-dplyr"><i class="fa fa-check"></i><b>7.3.6</b> Utilisation de dplyr</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="afm.html"><a href="afm.html"><i class="fa fa-check"></i><b>8</b> AFM, biodiversité et Open Data</a><ul>
<li class="chapter" data-level="8.1" data-path="analyse-factorielle-multiple-afm.html"><a href="analyse-factorielle-multiple-afm.html"><i class="fa fa-check"></i><b>8.1</b> Analyse factorielle multiple (AFM)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="analyse-factorielle-multiple-afm.html"><a href="analyse-factorielle-multiple-afm.html#afm-dans-sciviewsr"><i class="fa fa-check"></i><b>8.1.1</b> AFM dans SciViews::R</a></li>
<li class="chapter" data-level="8.1.2" data-path="analyse-factorielle-multiple-afm.html"><a href="analyse-factorielle-multiple-afm.html#plancton-en-mediterranee"><i class="fa fa-check"></i><b>8.1.2</b> Plancton en Méditerranée</a></li>
<li class="chapter" data-level="8.1.3" data-path="analyse-factorielle-multiple-afm.html"><a href="analyse-factorielle-multiple-afm.html#afm-avec-donnees-mixtes"><i class="fa fa-check"></i><b>8.1.3</b> AFM avec données mixtes</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="indices-de-biodiversite.html"><a href="indices-de-biodiversite.html"><i class="fa fa-check"></i><b>8.2</b> Indices de biodiversité</a><ul>
<li class="chapter" data-level="8.2.1" data-path="indices-de-biodiversite.html"><a href="indices-de-biodiversite.html#diversite-alpha"><i class="fa fa-check"></i><b>8.2.1</b> Diversité alpha</a></li>
<li class="chapter" data-level="8.2.2" data-path="indices-de-biodiversite.html"><a href="indices-de-biodiversite.html#diversite-beta"><i class="fa fa-check"></i><b>8.2.2</b> Diversité beta</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="open-data.html"><a href="open-data.html"><i class="fa fa-check"></i><b>8.3</b> Open Data</a><ul>
<li class="chapter" data-level="8.3.1" data-path="open-data.html"><a href="open-data.html#gestion-des-donnees"><i class="fa fa-check"></i><b>8.3.1</b> Gestion des données</a></li>
<li class="chapter" data-level="8.3.2" data-path="open-data.html"><a href="open-data.html#utilisation-de-donnees-ouvertes-open-data"><i class="fa fa-check"></i><b>8.3.2</b> Utilisation de données ouvertes (<em>Open Data</em>)</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="svbox.html"><a href="svbox.html"><i class="fa fa-check"></i><b>A</b> Installation de la SciViews Box</a><ul>
<li class="chapter" data-level="A.1" data-path="migration-des-projets.html"><a href="migration-des-projets.html"><i class="fa fa-check"></i><b>A.1</b> Migration des projets</a></li>
<li class="chapter" data-level="A.2" data-path="configuration-git-et-github.html"><a href="configuration-git-et-github.html"><i class="fa fa-check"></i><b>A.2</b> Configuration Git et Github</a><ul>
<li class="chapter" data-level="A.2.1" data-path="configuration-git-et-github.html"><a href="configuration-git-et-github.html#compte-github-dans-rstudio"><i class="fa fa-check"></i><b>A.2.1</b> Compte Github dans RStudio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>Références</a></li>
<li class="divider"></li>
<li><a href="https://wp.sciviews.org/sdd-umons2">Dernière version de ce cours</a></li>
<li><a href="https://wp.sciviews.org">Site Web du cours</a></li>
<li><a href="https://github.com/BioDataScience-Course">Site Github du cours</a></li>
<br/>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publié avec bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Science des données biologiques 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="positionnement-multidimensionnel-mds" class="section level2">
<h2><span class="header-section-number">6.2</span> Positionnement multidimensionnel (MDS)</h2>
<p>Le positionnement multidimensionnel, ou “multidimensional scaling” en anglais, d’où son acronyme fréquemment utilisé en français également : le MDS, est une autre façon de représenter clairement l’information contenue dans une matrice de distances. Ici, l’objectif n’est pas de <strong>regrouper</strong> ou de <strong>classifier</strong> les individus du tableau, mais de les <strong>ordonner</strong> sur un graphique en nuage de points en deux ou trois dimensions. Ce graphique s’appelle une “carte”, et la technique qui la réalise est une <strong>méthode d’ordination</strong>.</p>
<p>Au départ, nous avons <em>p</em> colonnes et <em>n</em> lignes dans le tableau cas par variables, c’est-à-dire, <em>p</em> variables quantitatives mesurées sur <em>n</em> individus distincts. Nous voulons déterminer les similitudes ou différences de ces <em>n</em> individus en les visualisant sur une carte où la distance d’un individu à l’autre représente cette similitude. Plus deux individus sont proches, plus ils sont semblables. Plus les individus sont éloignés, plus ils diffèrent. Ces distances entre paires d’individus, nous les avons déjà calculées dans la matrice de distances. Mais comment les représenter ? En effet, une représentation exacte ne peut se faire que dans un espace à <em>p</em> dimensions (même nombre de dimensions que de variables initiales). Donc, afin de réduire les dimensions à seulement 2 ou 3, nous allons devoir “tordre” les données et accepter de perdre un peu d’information. Ce que nous allons faire avec la MDS correspond exactement à cela : nous allons littéralement “écraser” les données dans un plan (deux dimensions) ou dans un espace à trois dimensions. C’est donc ce qu’on appelle une technique de <strong>réduction de dimensions</strong>.</p>
<p><img src="images/sdd2_06/tenor.gif" /></p>
<p>Il existe, en réalité, plusieurs techniques de MDS. Elle répondent toutes au schéma suivant :</p>
<ul>
<li>A partir d’un tableau multivarié de <em>n</em> lignes et <em>p</em> colonnes, nous calculons une matrice de distances (le choix de la transformation initiale éventuelle et de la métrique de distance utilisée sont totalement libres ici<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>).</li>
<li>Nous souhaitons représenter une carte (nuage de points) à <em>k</em> dimensions (<em>k</em> = 2, éventuellement <em>k</em> = 3) où les <em>n</em> individus seront placés de telle façon que les proximités exprimées par des valeurs faibles dans la matrice de dissimilarité soient respectées <em>autant que possible</em> entre tous les points.</li>
<li>Pour y arriver les points sont placés successivement sur la carte et réajustés afin de minimiser une <strong>fonction de coût</strong>, encore appelée <strong>fonction de stress</strong> qui quantifie de combien nous avons dû “tordre” le réseau à <em>p</em> dimensions initial représentant les distances entre toutes les paires. C’est en adoptant différentes fonctions de stress que nous aboutissons aux différentes variantes de MDS. La fonction de stress est représentée graphiquement (voir ci-dessous) pour diagnostiquer le traitement réaliser et décider si la représentation est utilisable (pas trop tordue) ou non.</li>
<li>Le positionnement des points faisant intervenir un facteur aléatoire (choix des points à placer en premier, réorganisation ensuite pour minimiser la fonction de stress), le résutat final peut varier d’une fois à l’autre sur les mêmes données, voir ne pas converger vers une solution stable. Il faut en être conscient.</li>
</ul>
<p>Nous vous épargnons ici les développements mathématiques qui mènent à la définition de la fonction de stress. Nous nous concentrerons sur les principales techniques et sur leurs propriétés utiles en pratique.</p>
<div id="mds-simplifiee-sous-sciviewsr" class="section level3">
<h3><span class="header-section-number">6.2.1</span> MDS simplifiée sous SciViews::R</h3>
<p>Dans R, il existe plus d’une dizaine de fonctions différentes pour réaliser le MDS. Afin de vous simplifier le travail et de pouvoir traiter votre MDS comme d’autres analyses similaires nous vous propoons les fonctions supplémentaites suivante. <strong>Ces fonctions sont à copier-coller en haut de vos scripts R, ou dans un chunk de “setup” à l’intérieur de vos documents R Markdown/Notebook.</strong></p>
<pre class="sourceCode r"><code class="sourceCode r">SciViews<span class="op">::</span><span class="kw">R</span>()
<span class="kw">library</span>(broom)

<span class="co"># function mds for several multidimensionnal scaling functions ------</span>
mds &lt;-<span class="st"> </span><span class="cf">function</span>(dist, <span class="dt">k =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;metric&quot;</span>, <span class="st">&quot;nonmetric&quot;</span>, <span class="st">&quot;cmdscale&quot;</span>,
<span class="st">&quot;wcmdscale&quot;</span>, <span class="st">&quot;sammon&quot;</span>, <span class="st">&quot;isoMDS&quot;</span>, <span class="st">&quot;monoMDS&quot;</span>, <span class="st">&quot;metaMDS&quot;</span>), <span class="dt">p =</span> <span class="dv">2</span>, ...) {
  type &lt;-<span class="st"> </span><span class="kw">match.arg</span>(type)
  res &lt;-<span class="st"> </span><span class="cf">switch</span>(type,
    <span class="dt">metric =</span> ,
    <span class="dt">wcmdscale =</span> <span class="kw">structure</span>(vegan<span class="op">::</span><span class="kw">wcmdscale</span>(<span class="dt">d =</span> dist, <span class="dt">k =</span> k, <span class="dt">eig =</span> <span class="ot">TRUE</span>, ...),
      <span class="dt">class =</span> <span class="kw">c</span>(<span class="st">&quot;wcmdscale&quot;</span>, <span class="st">&quot;mds&quot;</span>, <span class="st">&quot;list&quot;</span>)),
    <span class="dt">cmdscale =</span> <span class="kw">structure</span>(stats<span class="op">::</span><span class="kw">cmdscale</span>(<span class="dt">d =</span> dist, <span class="dt">k =</span> k, <span class="dt">eig =</span> <span class="ot">TRUE</span>, ...),
      <span class="dt">class =</span> <span class="kw">c</span>(<span class="st">&quot;cmdscale&quot;</span>, <span class="st">&quot;mds&quot;</span>, <span class="st">&quot;list&quot;</span>)),
    <span class="dt">nonmetric =</span> ,
    <span class="dt">metaMDS =</span> <span class="kw">structure</span>(vegan<span class="op">::</span><span class="kw">metaMDS</span>(<span class="dt">comm =</span> dist, <span class="dt">k =</span> k, ...),
      <span class="dt">class =</span> <span class="kw">c</span>(<span class="st">&quot;metaMDS&quot;</span>, <span class="st">&quot;monoMDS&quot;</span>, <span class="st">&quot;mds&quot;</span>, <span class="st">&quot;list&quot;</span>)),
    <span class="dt">isoMDS =</span> <span class="kw">structure</span>(MASS<span class="op">::</span><span class="kw">isoMDS</span>(<span class="dt">d =</span> dist, <span class="dt">k =</span> k, ...),
      <span class="dt">class =</span> <span class="kw">c</span>(<span class="st">&quot;isoMDS&quot;</span>, <span class="st">&quot;mds&quot;</span>, <span class="st">&quot;list&quot;</span>)),
    <span class="dt">monoMDS =</span> <span class="kw">structure</span>(vegan<span class="op">::</span><span class="kw">monoMDS</span>(<span class="dt">dist =</span> dist, <span class="dt">k =</span> k, ...),
      <span class="dt">class =</span> <span class="kw">c</span>(<span class="st">&quot;monoMDS&quot;</span>, <span class="st">&quot;mds&quot;</span>, <span class="st">&quot;list&quot;</span>)),
    <span class="dt">sammon =</span> <span class="kw">structure</span>(MASS<span class="op">::</span><span class="kw">sammon</span>(<span class="dt">d =</span> dist, <span class="dt">k =</span> k, ...),
      <span class="dt">class =</span> <span class="kw">c</span>(<span class="st">&quot;sammon&quot;</span>, <span class="st">&quot;mds&quot;</span>, <span class="st">&quot;list&quot;</span>)),
    <span class="kw">stop</span>(<span class="st">&quot;Unknown &#39;mds&#39; type &quot;</span>, type)
  )
  <span class="co"># For non-metric MDS, we add also data required for the Shepard plot</span>
  <span class="cf">if</span> (type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;nonmetric&quot;</span>, <span class="st">&quot;sammon&quot;</span>, <span class="st">&quot;isoMDS&quot;</span>, <span class="st">&quot;monoMDS&quot;</span>, <span class="st">&quot;metaMDS&quot;</span>))
    res<span class="op">$</span>Shepard &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw">Shepard</span>(<span class="dt">d =</span> dist, <span class="dt">x =</span> res<span class="op">$</span>points, <span class="dt">p =</span> p)
    res
}
<span class="kw">class</span>(mds) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;function&quot;</span>, <span class="st">&quot;subsettable_type&quot;</span>)

<span class="co"># plot.mds : MDS2 ~ MDS1 --------------------------------</span>
plot.mds &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, ...) {
  points &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>(x<span class="op">$</span>points, <span class="dt">.name_repair =</span> <span class="st">&quot;minimal&quot;</span>)
  <span class="kw">colnames</span>(points) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;mds&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(points))
  
  <span class="kw">plot</span>(<span class="dt">data =</span> points, mds2 <span class="op">~</span><span class="st"> </span>mds1,...)
}

autoplot.mds &lt;-<span class="st"> </span><span class="cf">function</span>(object, labels, ...) {
  points &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>(object<span class="op">$</span>points, <span class="dt">.name_repair =</span> <span class="st">&quot;minimal&quot;</span>)
  <span class="kw">colnames</span>(points) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;mds&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(points))
  
  <span class="cf">if</span> (<span class="op">!</span><span class="kw">missing</span>(labels)) {
    <span class="cf">if</span> (<span class="kw">length</span>(labels) <span class="op">!=</span><span class="st"> </span><span class="kw">nrow</span>(points))
      <span class="kw">stop</span>(<span class="st">&quot;You must provide a character vector of length &quot;</span>, <span class="kw">nrow</span>(points),
        <span class="st">&quot; for &#39;labels&#39;&quot;</span>)
    points<span class="op">$</span>.labels &lt;-<span class="st"> </span>labels
    chart<span class="op">::</span><span class="kw">chart</span>(points, mds2 <span class="op">~</span><span class="st"> </span>mds1 <span class="op">%label=%</span><span class="st"> </span>.labels, ...) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">      </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>() <span class="op">+</span>
<span class="st">      </span><span class="kw">coord_fixed</span>(<span class="dt">ratio =</span> <span class="dv">1</span>)
  } <span class="cf">else</span> {<span class="co"># Plot without labels</span>
    chart<span class="op">::</span><span class="kw">chart</span>(points, mds2 <span class="op">~</span><span class="st"> </span>mds1, ...) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">      </span><span class="kw">coord_fixed</span>(<span class="dt">ratio =</span> <span class="dv">1</span>)
  }
}

shepard &lt;-<span class="st"> </span><span class="cf">function</span>(dist, mds, <span class="dt">p =</span> <span class="dv">2</span>)
  <span class="kw">structure</span>(MASS<span class="op">::</span><span class="kw">Shepard</span>(<span class="dt">d =</span> dist, <span class="dt">x =</span> mds<span class="op">$</span>points, <span class="dt">p =</span> p),
    <span class="dt">class =</span> <span class="kw">c</span>(<span class="st">&quot;shepard&quot;</span>, <span class="st">&quot;list&quot;</span>))

plot.shepard &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">l.col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">l.lwd =</span> <span class="dv">1</span>,
<span class="dt">xlab =</span> <span class="st">&quot;Observed Dissimilarity&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Ordination Distance&quot;</span>, ...) {
  she &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>(x, <span class="dt">.name_repair =</span> <span class="st">&quot;minimal&quot;</span>)
  
  <span class="kw">plot</span>(<span class="dt">data =</span> she, y <span class="op">~</span><span class="st"> </span>x, <span class="dt">xlab =</span> xlab, <span class="dt">ylab =</span> ylab, ...)
  <span class="kw">lines</span>(<span class="dt">data =</span> she, yf <span class="op">~</span><span class="st"> </span>x, <span class="dt">type =</span> <span class="st">&quot;S&quot;</span>, <span class="dt">col =</span> l.col, <span class="dt">lwd =</span> l.lwd)
}

autoplot.shepard &lt;-<span class="st"> </span><span class="cf">function</span>(object,  <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">l.col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">l.lwd =</span> <span class="dv">1</span>,
<span class="dt">xlab =</span> <span class="st">&quot;Observed Dissimilarity&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Ordination Distance&quot;</span>, ...) {
  she &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw">as_tibble</span>(object)
  
  <span class="kw">chart</span>(<span class="dt">data =</span> she, y <span class="op">~</span><span class="st"> </span>x) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> alpha) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_step</span>(chart<span class="op">::</span><span class="kw">f_aes</span>(yf <span class="op">~</span><span class="st"> </span>x), <span class="dt">direction =</span> <span class="st">&quot;vh&quot;</span>, <span class="dt">col =</span> l.col, <span class="dt">lwd =</span> l.lwd) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> xlab, <span class="dt">y =</span> ylab)
}

<span class="co"># augment.mds -------------------------------------------</span>
augment.mds &lt;-<span class="st"> </span><span class="cf">function</span>(x, data, ...){
  points &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(x<span class="op">$</span>points)
  <span class="kw">colnames</span>(points) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;.mds&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(points))
  <span class="kw">bind_cols</span>(data, points)
}

<span class="co"># glance.mds -------------------------------------------</span>
glance.mds &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...){
  <span class="cf">if</span> (<span class="st">&quot;GOF&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(x)) {<span class="co"># Probably cmdscale() or wcmdscale() =&gt; metric MDS</span>
    tibble<span class="op">::</span><span class="kw">tibble</span>(<span class="dt">GOF1 =</span> x<span class="op">$</span>GOF[<span class="dv">1</span>], <span class="dt">GOF2 =</span> x<span class="op">$</span>GOF[<span class="dv">2</span>])
  } <span class="cf">else</span> {<span class="co"># Non metric MDS</span>
    <span class="co"># Calculate linear and non linear R^2 from the Shepard (stress) plot</span>
    tibble<span class="op">::</span><span class="kw">tibble</span>(
      <span class="dt">linear_R2 =</span> <span class="kw">cor</span>(x<span class="op">$</span>Shepard<span class="op">$</span>y, x<span class="op">$</span>Shepard<span class="op">$</span>yf)<span class="op">^</span><span class="dv">2</span>,
      <span class="dt">nonmetric_R2 =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(vegan<span class="op">::</span><span class="kw">goodness</span>(x)<span class="op">^</span><span class="dv">2</span>)
    )
  }
}</code></pre>
</div>
<div id="mds-metrique-ou-pcoa" class="section level3">
<h3><span class="header-section-number">6.2.2</span> MDS métrique ou PCoA</h3>
<p>La forme classique, aussi appelée <strong>MDS métrique</strong> ou <strong>analyse en coordonnées principales</strong> (Principal Coordinates Analysis en anglais ou PCoA), va <em>projetter</em> le nuage de points à <em>p</em> dimensions dans un espace réduit à <em>k</em> = 2 dimensions (voire éventuellement à 3 dimensions). Cette projection se fait de manière similaire à une ombre chinoise projettée d’un objet tridimensionnel sur une surface plane en deux dimensions.</p>
<div class="figure">
<img src="images/sdd2_06/shadow.jpg" alt="Ombre chinoise : un placement astucieux des mains dans le faisceau lumineux permet de projetter l’ombre d’un animal ou d’un objet sur une surface plane. La PCoA fait de même avec vos données." />
<p class="caption">Ombre chinoise : un placement astucieux des mains dans le faisceau lumineux permet de projetter l’ombre d’un animal ou d’un objet sur une surface plane. La PCoA fait de même avec vos données.</p>
</div>
<p>Considérons un relevé de couverture végétale en 24 stations concernant 44 plantes répertoriées sur le site de l’étude, par exemple, <code>Callvulg</code> est <em><a href="https://www.tela-botanica.org/bdtfx-nn-12262-synthese">Calluna vulgaris</a></em>, <code>Empenigr</code> est <em><a href="https://www.tela-botanica.org/bdtfx-nn-23935-synthese">Empetrum nigrum</a></em>, etc. Les valeurs sont les couvertures végétales observées pour chaque plante sur le site, expérimées en pourcents. La première colonne nommée <code>rownames</code> à l’importation contient les identifiants des stations (chaînes de caractères). Nous la renommons donc pour un intitulé plus explicite : <code>station</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">read</span>(<span class="st">&quot;varespec&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;vegan&quot;</span>) <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">rename</span>(., <span class="dt">station =</span> rownames) -&gt;<span class="st"> </span>veg
veg</code></pre>
<pre><code># # A tibble: 24 x 45
#    station Callvulg Empenigr Rhodtome Vaccmyrt Vaccviti Pinusylv Descflex
#    &lt;chr&gt;      &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
#  1 18          0.55    11.1      0        0       17.8      0.07     0   
#  2 15          0.67     0.17     0        0.35    12.1      0.12     0   
#  3 24          0.1      1.55     0        0       13.5      0.25     0   
#  4 27          0       15.1      2.42     5.92    16.0      0        3.7 
#  5 23          0       12.7      0        0       23.7      0.03     0   
#  6 19          0        8.92     0        2.42    10.3      0.12     0.02
#  7 22          4.73     5.12     1.55     6.05    12.4      0.1      0.78
#  8 16          4.47     7.33     0        2.15     4.33     0.1      0   
#  9 28          0        1.63     0.35    18.3      7.13     0.05     0.4 
# 10 13         24.1      1.9      0.07     0.22     5.3      0.12     0   
# # … with 14 more rows, and 37 more variables: Betupube &lt;dbl&gt;,
# #   Vacculig &lt;dbl&gt;, Diphcomp &lt;dbl&gt;, Dicrsp &lt;dbl&gt;, Dicrfusc &lt;dbl&gt;,
# #   Dicrpoly &lt;dbl&gt;, Hylosple &lt;dbl&gt;, Pleuschr &lt;dbl&gt;, Polypili &lt;dbl&gt;,
# #   Polyjuni &lt;dbl&gt;, Polycomm &lt;dbl&gt;, Pohlnuta &lt;dbl&gt;, Ptilcili &lt;dbl&gt;,
# #   Barbhatc &lt;dbl&gt;, Cladarbu &lt;dbl&gt;, Cladrang &lt;dbl&gt;, Cladstel &lt;dbl&gt;,
# #   Cladunci &lt;dbl&gt;, Cladcocc &lt;dbl&gt;, Cladcorn &lt;dbl&gt;, Cladgrac &lt;dbl&gt;,
# #   Cladfimb &lt;dbl&gt;, Cladcris &lt;dbl&gt;, Cladchlo &lt;dbl&gt;, Cladbotr &lt;dbl&gt;,
# #   Cladamau &lt;dbl&gt;, Cladsp &lt;dbl&gt;, Cetreric &lt;dbl&gt;, Cetrisla &lt;dbl&gt;,
# #   Flavniva &lt;dbl&gt;, Nepharct &lt;dbl&gt;, Stersp &lt;dbl&gt;, Peltapht &lt;dbl&gt;,
# #   Icmaeric &lt;dbl&gt;, Cladcerv &lt;dbl&gt;, Claddefo &lt;dbl&gt;, Cladphyl &lt;dbl&gt;</code></pre>
<p>Typiquement ce genre de données ne contient pas d’information constructive lorsqu’une plante est simultanément absente de deux stations (double zéros). Donc, les métriques de type euclidienne ou Manhattan ne conviennent pas ici. Nous devons choisir entre distance de Bray-Curtis ou Canberra en fonction de l’importance que nous souhaitons donner aux plantes les plus rares (avec couverture végétale faible et/ou absentes de la majorité des stations).</p>
<p>Afin de décider quelle métrique utiliser, visualisons à présent l’abondance ou la rareté des différentes plantes :</p>
<pre class="sourceCode r"><code class="sourceCode r">veg <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">select</span>(., <span class="op">-</span>station) <span class="op">%&gt;.%</span><span class="st"> </span><span class="co"># Colonne &#39;station&#39; pas utile ici</span>
<span class="st">  </span><span class="kw">gather</span>(., <span class="dt">key =</span> <span class="st">&quot;espèce&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;couverture&quot;</span>) <span class="op">%&gt;.%</span><span class="st"> </span><span class="co"># Tableau en format long</span>
<span class="st">  </span><span class="kw">chart</span>(., couverture <span class="op">~</span><span class="st"> </span>espèce) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="co"># Boites de dispersion</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Espèce&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Couverture [%]&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_flip</span>() <span class="co"># Labels plus lisibles si sur l&#39;axe Y</span></code></pre>
<p><img src="06-k-moyenne-som_files/figure-html/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Comme nous pouvions nous y attendre, sept ou huit espèces dominent la couverture végétales et les autres données sont complètement écrasées à zéro sur l’axe pour la majorité des stations. Si nous utilisons la distance de Bray-Curtis, l’analyse sera pratiquement réalisée sur seulement ces quelques espèces dominantes. Avec Canberra, nous risquons par contre de donner beaucoup trop d’importance aux espèces extrêmement rares (toutes les espèces ont une importance égale avec cette métrique). Une solution intermédiaire est de transformer les données pour réduire l’écart d’importance entre les espèces abondantes et les rares, soit avec <span class="math inline">\(log(x + 1)\)</span>, soit avec <span class="math inline">\(\sqrt{\sqrt{x}}\)</span>. Voyons ce que donne la transformation logarithmique ici en utilisant la fonction <code>log1p()</code> dans R.</p>
<pre class="sourceCode r"><code class="sourceCode r">veg <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">select</span>(., <span class="op">-</span>station) <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">gather</span>(., <span class="dt">key =</span> <span class="st">&quot;espèce&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;couverture&quot;</span>) <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">chart</span>(., <span class="kw">log1p</span>(couverture) <span class="op">~</span><span class="st"> </span>espèce) <span class="op">+</span><span class="st"> </span><span class="co"># Transformation log(couverture + 1)</span>
<span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Espèce&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Couverture [%]&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_flip</span>()</code></pre>
<p><img src="06-k-moyenne-som_files/figure-html/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>C’est nettement mieux car les données concernant les espèces rares ne sont plus totalement écrasées vers zéro sur l’axe horizontal ! La matrice de distances de Bray-Curtis sur nos données transformées log est la <strong>première étape</strong> de l’analyse :</p>
<pre class="sourceCode r"><code class="sourceCode r">veg <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">select</span>(., <span class="op">-</span>station) <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">log1p</span>(.) <span class="op">%&gt;.%</span>
<span class="st">  </span>vegan<span class="op">::</span><span class="kw">vegdist</span>(., <span class="dt">method =</span> <span class="st">&quot;bray&quot;</span>) -&gt;<span class="st"> </span>veg_dist</code></pre>
<p>N’imprimez pas le contenu de <code>veg_dist</code> ! C’est de toutes façons illisible. La PCoA va visualiser son contenu de manière bien plus utile. La <strong>seconde étape</strong> consiste à calculer notre MDS métrique en utilisant <code>mds$metric()</code></p>
<pre class="sourceCode r"><code class="sourceCode r">veg_mds &lt;-<span class="st"> </span>mds<span class="op">$</span><span class="kw">metric</span>(veg_dist)</code></pre>
<p>Ensuite, <strong>troisième étape</strong>, le but étant de visualiser les distances nous effectons immédiatement un graphique comme suit :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">autoplot</span>(veg_mds, <span class="dt">labels =</span> veg<span class="op">$</span>station)</code></pre>
<p><img src="06-k-moyenne-som_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Ce graphique s’interprète comme suit :</p>
<ul>
<li>Des stations proches l’une de l’autre sur la carte ont des indices de dissimilarité faibles. Ces stations sont semblables du point de vue de la couverture végétale.</li>
<li>Plus les stations sont éloignées les unes des autres, plus elles sont dissemblables.</li>
<li>Si des regroupements apparaissent sur la carte, il se peut que ce soit des biotopes semblables, et qui diffèrent des autres regroupements. Par exemple ici, les stations 14–15, 20 et 22–25 forment un groupe relativement homogène en haut à gauche du graphique qui s’individualise du reste. Au contraire, les stations 5, 21, ou encore 27 ou 28 sont relativement isolées et constituent donc des assemblages végétaux uniques.</li>
<li>Les stations aux extrémités sont des configurations extrêmes ; celles au centre sont des configurations plus courantes.</li>
<li>Par contre, ni l’orientation des axes, ni les valeurs absolues sur ces axes n’ont de significations particulières ici. N’en tenez pas compte.</li>
</ul>

<div class="warning">
<p>Attention : rien ne garantit que notre MDS métrique projettée en deux dimensions soit suffisamment représentative des données dans leur ensemble. Si la méthode n’a pas réussi à représenter fidèlement les données, c’est que ces dernières sont trop complexes et ne s’y prêtent pas. Contrôlez donc toujours les indicateurs que sont les valeurs de “Goodness-of-fit” (GOF, qualité d’ajustement).</p>
</div>

<p>Les indicateurs “GOF” sont obtenus via la fonction <code>glance()</code> :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(veg_mds)</code></pre>
<pre><code># # A tibble: 1 x 2
#    GOF1  GOF2
#   &lt;dbl&gt; &lt;dbl&gt;
# 1 0.527 0.554</code></pre>
<p>Ici <code>GOF1</code> est la somme des valeurs propres obtenues lors du calcul (ces valeurs propres vous seront expliquées dans le module suivant consacré à l’ACP). Retenez simplement que c’est une mesure de la part de variance du jeu de données initial qui a pu être représentée sur la carte. Plus la valeur se rapproche de 1, mieux c’est, avec des valeurs &gt; 0.7 ou 0.8 qui restent acceptables. Le second indicateur, <code>GOF2</code> est la somme uniquement des valeurs propres positives. Certains préfèrent ce dernier indicateur. En principe, les deux sont proches ou égaux. Donc, le choix de l’un ou de l’autre ne devrait pas fondamentalement modifier vos conclusions.</p>
<p><strong>Ici, avec des valeurs de goodness-of-fit à peine supérieures à 50% nous pouvons considérer que la carte n’est pas suffisamment représentative.</strong> Soit nous tentons de la représenter en trois dimensions (mais c’est rarement plus lisible car il faut quand même se résigner à présenter ce graphique 3D dans un plan à deux dimensions -l’écran de l’ordinateur, ou une feuille de papier- au final). Une autre solution lorsque la MDS métrique ne donne pas satisfaction est de se tourner vers la MDs non métrique. Ce que nous allons faire ci-dessous.</p>

<div class="note">
<p>A noter que la PCoA sur matrice euclidienne après standardisation ou non des données est équivalente à une <strong>Analyse en Composantes Principales</strong> (ACP) que nous étudierons dans le module suivant, … mais avec un calcul nettement moins efficace. Dans ce contexte, la PCoA n’a donc pas grand intérêt. Elle est surtout utile lorsque vous voulez représenter des métriques de distances <em>différentes</em> de la distance euclidienne comme c’est le cas ici avec un choix de distances de Bray-Curtis.</p>
</div>

</div>
<div id="mds-non-metrique" class="section level3">
<h3><span class="header-section-number">6.2.3</span> MDS non métrique</h3>
<p>La version non métrique de la MDS vise à réaliser une carte sur base de la matrice de distances, mais en autorisant des écarts plus flexibles entre les individus… pour autant que des individus similaires restent plus proches les uns des autres que des individus plus différents, et ce, partout sur la carte. Donc, une dissimilarité donnée pourra être “compressée” ou “dilatée”, pour autant que la distortion garde l’ordre des points intacts. Cela signifie que la distortion se fera via une fonction monotone croissante (une dissimilarité plus grande ne pouvant pas être représentée par une distance plus petite sur la carte).</p>
<p>La distortion ainsi introduite est appelée un <strong>stress</strong>. C’est un peu comme si vous écrasiez par la force un objet 3D sur une surface plane, au lieu de juste en projeter l’ombre. Comme il existe différentes fonctions de stress, il existe donc différentes versions de MDS non métriques. Ici, nous nous attacherons à maitriser une version implémentée dans <code>mds$nonmetric()</code>. Il s’agit de l’une des premières formes de MDS non métriques qui a été proposée par le statisticien Joseph Kruskal (on parle aussi du positionnement multidimensionnel de Kruskal).</p>
<p>La logique est la même que pour la MDS métrique :</p>
<ul>
<li>étape 1 : construction d’une matrice de distances,</li>
<li>étape 2 : calcul du positionnement des points,</li>
<li>étape 3 : réalisation de la carte et vérification de sa validité.</li>
</ul>
<p>Repartons de la même matrice de distances déjà réalisée pour la MDS métrique qui se nomme <code>veg_dist</code>. Le calcul est itératif. Comme il n’est pas garanti de converger, ni de donner la meilleure réponse, nous utilisons ici une fonction “intelligente” qui va effectuer une recherche plus poussée de la solution optimale, notamment en partant de différentes configurations au départ. Pour les détails et les paramètres de cet algorithme, voyez l’aide en ligne de la fonction <code>?vegan::metaMDS</code>. Dans le cadre de ce cours, nous ferons confiance au travail réalisé et vérifierons juste qu’une solution est trouvée (indication <code>*** Solution reached</code> à la fin). Notez toutefois que le stress est quantifié. Il tourne ici autour de 0,126. Plus la valeur de stress est basse, mieux c’est naturellement.</p>
<pre class="sourceCode r"><code class="sourceCode r">veg_nmds &lt;-<span class="st"> </span>mds<span class="op">$</span><span class="kw">nonmetric</span>(veg_dist) <span class="co"># Calcul</span></code></pre>
<pre><code># Run 0 stress 0.1256617 
# Run 1 stress 0.1262346 
# Run 2 stress 0.1262346 
# Run 3 stress 0.1262346 
# Run 4 stress 0.1256617 
# ... Procrustes: rmse 1.056302e-05  max resid 3.244521e-05 
# ... Similar to previous best
# Run 5 stress 0.1256617 
# ... Procrustes: rmse 6.34123e-06  max resid 1.783762e-05 
# ... Similar to previous best
# Run 6 stress 0.1256617 
# ... Procrustes: rmse 1.768348e-05  max resid 4.243365e-05 
# ... Similar to previous best
# Run 7 stress 0.1262346 
# Run 8 stress 0.1262346 
# Run 9 stress 0.1256617 
# ... Procrustes: rmse 1.668964e-05  max resid 5.282751e-05 
# ... Similar to previous best
# Run 10 stress 0.1262347 
# Run 11 stress 0.1912667 
# Run 12 stress 0.1262346 
# Run 13 stress 0.1256617 
# ... Procrustes: rmse 1.797304e-05  max resid 5.269659e-05 
# ... Similar to previous best
# Run 14 stress 0.1256617 
# ... Procrustes: rmse 1.209131e-05  max resid 3.718001e-05 
# ... Similar to previous best
# Run 15 stress 0.2004491 
# Run 16 stress 0.1256617 
# ... New best solution
# ... Procrustes: rmse 9.079683e-06  max resid 3.527497e-05 
# ... Similar to previous best
# Run 17 stress 0.1262347 
# Run 18 stress 0.1262346 
# Run 19 stress 0.2250581 
# Run 20 stress 0.2105936 
# *** Solution reached</code></pre>
<p>A présent, nous pouvons représenter la carte.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">autoplot</span>(veg_nmds, <span class="dt">labels =</span> veg<span class="op">$</span>station)</code></pre>
<p><img src="06-k-moyenne-som_files/figure-html/unnamed-chunk-38-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Nous avons une représentation assez différente de celle de la MDS métrique. Les stations 5, 21, 27 et 28 sont toujours isolées, mais le reste est regroupé de manière plus homogène. Comment savoir si cette représentation est meilleure que la version métrique qui avait une “goodness-of-fit” décevante ? En visualisant les indicateurs de qualité d’ajustement, ainsi que la fonction de stress sur un graphique dit <strong>graphique de Shepard</strong>. Comme d’habitude, <code>glance()</code> nous donne les statistiques voulues.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(veg_nmds)</code></pre>
<pre><code># # A tibble: 1 x 2
#   linear_R2 nonmetric_R2
#       &lt;dbl&gt;        &lt;dbl&gt;
# 1     0.919        0.984</code></pre>
<p>Le premier indicateur (R<sup>2</sup> linéaire) est le coefficient de corrélation linéaire de Pearson entre les distances ajustées et les distances sur la carte au carré. Plus cette valeur est proche de un, moins les distances sont tordues. Le second indicateur, le R<sup>2</sup> non métrique est calculé comme 1 - S<sup>2</sup> où S est le stress (tel que quantifié plus haut lors de l’appel à la fonction <code>mds$nonmetric()</code>). Cette dernière statistique indique si l’<em>ordre</em> des points respecte l’<em>ordre</em> des distances partout sur le graphique. Avec 0,98, la valeur est excellente ici. Ensuite le R<sup>2</sup> linéaire nous indique de combien les différentes distances sont éventuellement distordues. Avec une valeur de 0,92, la distortion n’est pas trop forte ici.</p>
<p>Le diagramme de Shepard permet de visualiser dans le détail la distortion introduite pour parvenir à réaliser la carte en deux dimensions.</p>
<pre class="sourceCode r"><code class="sourceCode r">veg_sh &lt;-<span class="st"> </span><span class="kw">shepard</span>(veg_dist, veg_nmds)
<span class="kw">autoplot</span>(veg_sh)</code></pre>
<p><img src="06-k-moyenne-som_files/figure-html/unnamed-chunk-40-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Sur l’axe des abscisses, nous avons les valeurs de dissimilarité présentes dans la matrice de distances. Sur l’axe des ordonnées, le graphique représente les distances de l’ordination, c’est-à-dire, les distances entre les paires de points sur la carte. Chaque point correspond à la dissimilarité d’une paire d’individus sur X, et à la distance entre cette paire sur la carte en Y. Enfin, le trait en escalier rouge matérialise la fonction monotone croissante choisie pour distordre les distances. C’est la <strong>fonction de stress</strong>.</p>
<p>Ce diagramme se lit comme suit :</p>
<ul>
<li>Plus les points sont proches de la fonction de stress, mieux c’est. Le R<sup>2</sup> non métrique sera également d’autant plus élevé que les points sont proches de la fonction.</li>
<li>Plus la fonction de stress est linéaire, plus les <em>distances</em> respectent les valeurs de <em>dissimilarités</em>. Le R<sup>2</sup> linéaire est lié à la plus ou moins bonne linéarité de la fonction de stress.</li>
</ul>
<p>Vous pouvez très bien décider que seul l’<em>ordre</em> des individus sur la carte compte. Dans ce cas, la forme de la fonction de stress et la valeur du R<sup>2</sup> linéaire importent peu. Seul compte la proximité la plus forte possible des points par rapport à la fonction de stress sur le diagramme de Shepard, ainsi donc que la valeur du R<sup>2</sup> non métrique.</p>
<p>Si par contre, vous voulez être plus contraignant, alors, les distances seront considérées également comme importantes. Vous rechercherez alors une fonction de stress pas trop éloignée d’une droite, ainsi qu’un R<sup>2</sup> linéaire élevé. Dans ce cas, nous nous rapprochons des exigences de la MDS métrique.</p>
<p>Ici, nous pouvons constater que les deux critères sont bons. Nous pouvons donc nous fier à la carte obtenue à l’aide de la MDs non métrique de Kruskal.</p>

<div class="warning">
<p>Restez toujours attentif à la taille du jeu de données que vous utilisez pour réaliser une MDS, en particuliers une MDS non métrique. Quelques centaines de lignes, ça dois passer, plusieurs dizaines de milliers ou plus, ça ne passera pas ! La limite dépend bien sûr de la puissance de votre ordinateur et de la quantité de mémoire vive disponible. Retenez toutefois que la quantité de calculs augmente drastiquement avec la taille du jeu de données à traiter.</p>
</div>

<div id="pour-en-savoir-plus-3" class="section level5 unnumbered">
<h5>Pour en savoir plus</h5>
<ul>
<li><p>La fonction <code>mds()</code> donne accès à d’autres versions de MDS non métriques également. Ainsi, <code>mds$isoMDS()</code> ou <code>mds$monoMDS()</code> correspondent toutes deux à la version de Kruskal mais en utilisant une seule configuration de départ (donc, moins robustes mais plus rapides à calculer). La <code>mds$sammon()</code> est une autre forme de MDS non métrique décrite dans l’aide en ligne de <code>?MASS::sammon</code>.</p></li>
<li><p>Des techniques existent pour déterminer la dimension <em>k</em> idéale de la carte. Le <strong>graphique des éboulis</strong> (screeplot en anglais) sera abordé au module suivante dans le cadre de l’ACP. Il en existe une version pour le MDS, voyez <a href="https://rpubs.com/YaPi/393252">ici</a> (en anglais).</p></li>
</ul>
</div>
<div id="a-vous-de-jouer-16" class="section level5 unnumbered">
<h5>A vous de jouer !</h5>
<ul>
<li>Réalisez le tutoriel afin de vérifier votre bonne compréhension de la mds.</li>
</ul>

<div class="bdd">
<p>Démarrez la SciViews Box et RStudio. Dans la fenêtre <strong>Console</strong> de RStudio, entrez l’instruction suivante suivie de la touche <code>Entrée</code> pour ouvrir le tutoriel concernant les bases de R :</p>
<pre><code>BioDataScience2::run(&quot;06b_mds&quot;)</code></pre>
N’oubliez pas d’appuyer sur la touche <code>ESC</code> pour reprendre la main dans R à la fin d’un tutoriel dans la console R.
</div>

<ul>
<li>Complétez votre carnet de note par binôme sur le transect entre Nice et Calvi débuté lors du module 5. Lisez attentivement le README (Ce dernier a été mis à jour).</li>
</ul>

<div class="bdd">
<p>Completez votre projet. Lisez attentivement le README.</p>
<p>La dernière version du README est disponible via le lien suivant :</p>
<ul>
<li><a href="https://github.com/BioDataScience-Course/spatial_distribution_zooplankton_ligurian_sea" class="uri">https://github.com/BioDataScience-Course/spatial_distribution_zooplankton_ligurian_sea</a>
</div></li>
</ul>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="17">
<li id="fn17"><p>Chaque métrique de distance offre un éclairage différent sur les données. Elles agissent comme autant de filtres différents à votre disposition pour explorer vos données multivariées.<a href="positionnement-multidimensionnel-mds.html#fnref17" class="footnote-back">↩</a></p></li>
</ol>
</div>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://sddb.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="k-moyennes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cartes-auto-adaptatives-som.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/BioDataScience-Course/sdd-umons2-2019/edit/master/06-k-moyenne-som.Rmd",
"text": "Editer"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
