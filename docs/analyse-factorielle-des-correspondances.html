<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>7.2 Analyse factorielle des correspondances | Science des données biologiques 2</title>
  <meta name="description" content="Tutoriel interactif pour la science des données avec R &amp; SciViews-R, partie 2.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="7.2 Analyse factorielle des correspondances | Science des données biologiques 2" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://biodatascience-course.sciviews.org/sdd-umons2-2019/" />
  <meta property="og:image" content="https://biodatascience-course.sciviews.org/sdd-umons2-2019/images/front-cover.png" />
  <meta property="og:description" content="Tutoriel interactif pour la science des données avec R &amp; SciViews-R, partie 2." />
  <meta name="github-repo" content="biodatascience-course/sdd-umons2-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.2 Analyse factorielle des correspondances | Science des données biologiques 2" />
  
  <meta name="twitter:description" content="Tutoriel interactif pour la science des données avec R &amp; SciViews-R, partie 2." />
  <meta name="twitter:image" content="https://biodatascience-course.sciviews.org/sdd-umons2-2019/images/front-cover.png" />

<meta name="author" content="Philippe Grosjean &amp; Guyliann Engels (avec des contributions de Raphaël Conotte)">


<meta name="date" content="2020-08-21">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="analyse-en-composantes-principales.html">
<link rel="next" href="acces-aux-bases-de-donnees.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.8.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.39.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.39.2/plotly-latest.min.js"></script>
<link href="libs/rglwidgetClass-2/rgl.css" rel="stylesheet" />
<script src="libs/rglwidgetClass-2/rglClass.src.js"></script>
<script src="libs/CanvasMatrix4-2016/CanvasMatrix.src.js"></script>
<script src="libs/rglWebGL-binding-0.100.19/rglWebGL.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Science des données biologiques 2</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préambule</a><ul>
<li class="chapter" data-level="" data-path="vue-generale-des-cours.html"><a href="vue-generale-des-cours.html"><i class="fa fa-check"></i>Vue générale des cours</a></li>
<li class="chapter" data-level="" data-path="materiel-pedagogique.html"><a href="materiel-pedagogique.html"><i class="fa fa-check"></i>Matériel pédagogique</a></li>
</ul></li>
<li class="part"><span><b>I Cours II: modélisation</b></span></li>
<li class="chapter" data-level="1" data-path="lm.html"><a href="lm.html"><i class="fa fa-check"></i><b>1</b> Régression linéaire I</a><ul>
<li class="chapter" data-level="1.1" data-path="modele.html"><a href="modele.html"><i class="fa fa-check"></i><b>1.1</b> Modèle</a><ul>
<li class="chapter" data-level="1.1.1" data-path="modele.html"><a href="modele.html#pourquoi-modeliser"><i class="fa fa-check"></i><b>1.1.1</b> Pourquoi modéliser ?</a></li>
<li class="chapter" data-level="1.1.2" data-path="modele.html"><a href="modele.html#quand-modeliser"><i class="fa fa-check"></i><b>1.1.2</b> Quand modéliser ?</a></li>
<li class="chapter" data-level="1.1.3" data-path="modele.html"><a href="modele.html#entrainement-et-confirmation"><i class="fa fa-check"></i><b>1.1.3</b> Entraînement et confirmation</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="regression-lineaire-simple.html"><a href="regression-lineaire-simple.html"><i class="fa fa-check"></i><b>1.2</b> Régression linéaire simple</a><ul>
<li class="chapter" data-level="1.2.1" data-path="regression-lineaire-simple.html"><a href="regression-lineaire-simple.html#quantifier-lajustement-dun-modele"><i class="fa fa-check"></i><b>1.2.1</b> Quantifier l’ajustement d’un modèle</a></li>
<li class="chapter" data-level="1.2.2" data-path="regression-lineaire-simple.html"><a href="regression-lineaire-simple.html#trouver-la-meilleure-droite"><i class="fa fa-check"></i><b>1.2.2</b> Trouver la meilleure droite</a></li>
<li class="chapter" data-level="1.2.3" data-path="regression-lineaire-simple.html"><a href="regression-lineaire-simple.html#la-fonction-lm"><i class="fa fa-check"></i><b>1.2.3</b> La fonction <code>lm()</code></a></li>
<li class="chapter" data-level="1.2.4" data-path="regression-lineaire-simple.html"><a href="regression-lineaire-simple.html#resume-avec-summary"><i class="fa fa-check"></i><b>1.2.4</b> Résumé avec <code>summary()</code></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="outils-de-diagnostic.html"><a href="outils-de-diagnostic.html"><i class="fa fa-check"></i><b>1.3</b> Outils de diagnostic</a><ul>
<li class="chapter" data-level="1.3.1" data-path="outils-de-diagnostic.html"><a href="outils-de-diagnostic.html#analyse-des-residus"><i class="fa fa-check"></i><b>1.3.1</b> Analyse des résidus</a></li>
<li class="chapter" data-level="1.3.2" data-path="outils-de-diagnostic.html"><a href="outils-de-diagnostic.html#enveloppe-de-confiance"><i class="fa fa-check"></i><b>1.3.2</b> Enveloppe de confiance</a></li>
<li class="chapter" data-level="1.3.3" data-path="outils-de-diagnostic.html"><a href="outils-de-diagnostic.html#extraire-les-donnees-dun-modele"><i class="fa fa-check"></i><b>1.3.3</b> Extraire les données d’un modèle</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lm2.html"><a href="lm2.html"><i class="fa fa-check"></i><b>2</b> Régression linéaire II</a><ul>
<li class="chapter" data-level="2.1" data-path="outils-de-diagnostic-suite.html"><a href="outils-de-diagnostic-suite.html"><i class="fa fa-check"></i><b>2.1</b> Outils de diagnostic (suite)</a><ul>
<li class="chapter" data-level="2.1.1" data-path="outils-de-diagnostic-suite.html"><a href="outils-de-diagnostic-suite.html#resume-avec-summarysuite"><i class="fa fa-check"></i><b>2.1.1</b> Résumé avec <code>summary()</code>(suite)</a></li>
<li class="chapter" data-level="2.1.2" data-path="outils-de-diagnostic-suite.html"><a href="outils-de-diagnostic-suite.html#comparaison-de-regressions"><i class="fa fa-check"></i><b>2.1.2</b> Comparaison de régressions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="regression-lineaire-multiple.html"><a href="regression-lineaire-multiple.html"><i class="fa fa-check"></i><b>2.2</b> Régression linéaire multiple</a></li>
<li class="chapter" data-level="2.3" data-path="regression-lineaire-polynomiale.html"><a href="regression-lineaire-polynomiale.html"><i class="fa fa-check"></i><b>2.3</b> Régression linéaire polynomiale</a></li>
<li class="chapter" data-level="2.4" data-path="rmse-critere-dakaike.html"><a href="rmse-critere-dakaike.html"><i class="fa fa-check"></i><b>2.4</b> RMSE &amp; critère d’Akaike</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mod-lineaire.html"><a href="mod-lineaire.html"><i class="fa fa-check"></i><b>3</b> Modèle linéaire</a><ul>
<li class="chapter" data-level="3.1" data-path="variables-numeriques-ou-facteurs.html"><a href="variables-numeriques-ou-facteurs.html"><i class="fa fa-check"></i><b>3.1</b> Variables numériques ou facteurs</a></li>
<li class="chapter" data-level="3.2" data-path="anova-et-regression-lineaire.html"><a href="anova-et-regression-lineaire.html"><i class="fa fa-check"></i><b>3.2</b> ANOVA et régression linéaire</a><ul>
<li class="chapter" data-level="3.2.1" data-path="anova-et-regression-lineaire.html"><a href="anova-et-regression-lineaire.html#modele-lineaire-commun"><i class="fa fa-check"></i><b>3.2.1</b> Modèle linéaire commun</a></li>
<li class="chapter" data-level="3.2.2" data-path="anova-et-regression-lineaire.html"><a href="anova-et-regression-lineaire.html#reencodage-des-variables-de-lanova"><i class="fa fa-check"></i><b>3.2.2</b> Réencodage des variables de l’ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="matrice-de-contraste.html"><a href="matrice-de-contraste.html"><i class="fa fa-check"></i><b>3.3</b> Matrice de contraste</a><ul>
<li class="chapter" data-level="3.3.1" data-path="matrice-de-contraste.html"><a href="matrice-de-contraste.html#contraste-orthogonaux"><i class="fa fa-check"></i><b>3.3.1</b> Contraste orthogonaux</a></li>
<li class="chapter" data-level="3.3.2" data-path="matrice-de-contraste.html"><a href="matrice-de-contraste.html#autres-matrices-de-contrastes-courantes"><i class="fa fa-check"></i><b>3.3.2</b> Autres matrices de contrastes courantes</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ancova.html"><a href="ancova.html"><i class="fa fa-check"></i><b>3.4</b> ANCOVA</a><ul>
<li class="chapter" data-level="3.4.1" data-path="ancova.html"><a href="ancova.html#bebes-a-la-naissance"><i class="fa fa-check"></i><b>3.4.1</b> Bébés à la naissance</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="modele-lineaire-generalise.html"><a href="modele-lineaire-generalise.html"><i class="fa fa-check"></i><b>3.5</b> Modèle linéaire généralisé</a><ul>
<li class="chapter" data-level="3.5.1" data-path="modele-lineaire-generalise.html"><a href="modele-lineaire-generalise.html#exemple"><i class="fa fa-check"></i><b>3.5.1</b> Exemple</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reg-non-lin.html"><a href="reg-non-lin.html"><i class="fa fa-check"></i><b>4</b> Régression non linéaire</a><ul>
<li class="chapter" data-level="4.1" data-path="rendement-photosynthetique.html"><a href="rendement-photosynthetique.html"><i class="fa fa-check"></i><b>4.1</b> Rendement photosynthétique</a></li>
<li class="chapter" data-level="4.2" data-path="principe.html"><a href="principe.html"><i class="fa fa-check"></i><b>4.2</b> Principe</a><ul>
<li class="chapter" data-level="4.2.1" data-path="principe.html"><a href="principe.html#fonction-objective"><i class="fa fa-check"></i><b>4.2.1</b> Fonction objective</a></li>
<li class="chapter" data-level="4.2.2" data-path="principe.html"><a href="principe.html#calcul-iteratif"><i class="fa fa-check"></i><b>4.2.2</b> Calcul itératif</a></li>
<li class="chapter" data-level="4.2.3" data-path="principe.html"><a href="principe.html#pieges-et-difficultes"><i class="fa fa-check"></i><b>4.2.3</b> Pièges et difficultés</a></li>
<li class="chapter" data-level="4.2.4" data-path="principe.html"><a href="principe.html#modeles-selfstart-dans-r"><i class="fa fa-check"></i><b>4.2.4</b> Modèles ‘selfStart’ dans R</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html"><i class="fa fa-check"></i><b>4.3</b> Modèles courants en biologie</a><ul>
<li class="chapter" data-level="4.3.1" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-de-michaelis-menten"><i class="fa fa-check"></i><b>4.3.1</b> Modèle de Michaelis-Menten</a></li>
<li class="chapter" data-level="4.3.2" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modeles-de-croissance"><i class="fa fa-check"></i><b>4.3.2</b> Modèles de croissance</a></li>
<li class="chapter" data-level="4.3.3" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#courbe-exponentielle"><i class="fa fa-check"></i><b>4.3.3</b> Courbe exponentielle</a></li>
<li class="chapter" data-level="4.3.4" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#courbe-logistique"><i class="fa fa-check"></i><b>4.3.4</b> Courbe logistique</a></li>
<li class="chapter" data-level="4.3.5" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-de-gompertz"><i class="fa fa-check"></i><b>4.3.5</b> Modèle de Gompertz</a></li>
<li class="chapter" data-level="4.3.6" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modeles-de-von-bertalanffy"><i class="fa fa-check"></i><b>4.3.6</b> Modèles de von Bertalanffy</a></li>
<li class="chapter" data-level="4.3.7" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-de-richards"><i class="fa fa-check"></i><b>4.3.7</b> Modèle de Richards</a></li>
<li class="chapter" data-level="4.3.8" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-de-weibull"><i class="fa fa-check"></i><b>4.3.8</b> Modèle de Weibull</a></li>
<li class="chapter" data-level="4.3.9" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-preece-baines-1"><i class="fa fa-check"></i><b>4.3.9</b> Modèle Preece-Baines 1</a></li>
<li class="chapter" data-level="4.3.10" data-path="modeles-courants-en-biologie.html"><a href="modeles-courants-en-biologie.html#modele-de-tanaka"><i class="fa fa-check"></i><b>4.3.10</b> Modèle de Tanaka</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="choix-du-modele.html"><a href="choix-du-modele.html"><i class="fa fa-check"></i><b>4.4</b> Choix du modèle</a></li>
</ul></li>
<li class="part"><span><b>II Cours II: analyse</b></span></li>
<li class="chapter" data-level="5" data-path="hierarchique.html"><a href="hierarchique.html"><i class="fa fa-check"></i><b>5</b> Classification hiérarchique</a><ul>
<li class="chapter" data-level="5.1" data-path="analyse-de-donnees.html"><a href="analyse-de-donnees.html"><i class="fa fa-check"></i><b>5.1</b> Analyse de données</a></li>
<li class="chapter" data-level="5.2" data-path="distance-entre-individus.html"><a href="distance-entre-individus.html"><i class="fa fa-check"></i><b>5.2</b> Distance entre individus</a><ul>
<li class="chapter" data-level="5.2.1" data-path="distance-entre-individus.html"><a href="distance-entre-individus.html#matrice-de-distances"><i class="fa fa-check"></i><b>5.2.1</b> Matrice de distances</a></li>
<li class="chapter" data-level="5.2.2" data-path="distance-entre-individus.html"><a href="distance-entre-individus.html#indices-de-dissimilarite"><i class="fa fa-check"></i><b>5.2.2</b> Indices de (dis)similarité</a></li>
<li class="chapter" data-level="5.2.3" data-path="distance-entre-individus.html"><a href="distance-entre-individus.html#utilisation-des-indices"><i class="fa fa-check"></i><b>5.2.3</b> Utilisation des indices</a></li>
<li class="chapter" data-level="5.2.4" data-path="distance-entre-individus.html"><a href="distance-entre-individus.html#proprietes-des-indices"><i class="fa fa-check"></i><b>5.2.4</b> Propriétés des indices</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="regroupement-avec-cah.html"><a href="regroupement-avec-cah.html"><i class="fa fa-check"></i><b>5.3</b> Regroupement avec CAH</a><ul>
<li class="chapter" data-level="5.3.1" data-path="regroupement-avec-cah.html"><a href="regroupement-avec-cah.html#dendrogramme"><i class="fa fa-check"></i><b>5.3.1</b> Dendrogramme</a></li>
<li class="chapter" data-level="5.3.2" data-path="regroupement-avec-cah.html"><a href="regroupement-avec-cah.html#separer-les-groupes"><i class="fa fa-check"></i><b>5.3.2</b> Séparer les groupes</a></li>
<li class="chapter" data-level="5.3.3" data-path="regroupement-avec-cah.html"><a href="regroupement-avec-cah.html#etude-complete"><i class="fa fa-check"></i><b>5.3.3</b> Étude complète</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="k-moyenne-mds-som.html"><a href="k-moyenne-mds-som.html"><i class="fa fa-check"></i><b>6</b> K-moyenne, MDS &amp; SOM</a><ul>
<li class="chapter" data-level="6.1" data-path="k-moyennes.html"><a href="k-moyennes.html"><i class="fa fa-check"></i><b>6.1</b> K-moyennes</a><ul>
<li class="chapter" data-level="6.1.1" data-path="k-moyennes.html"><a href="k-moyennes.html#exemple-simple"><i class="fa fa-check"></i><b>6.1.1</b> Exemple simple</a></li>
<li class="chapter" data-level="6.1.2" data-path="k-moyennes.html"><a href="k-moyennes.html#classification-du-zooplancton"><i class="fa fa-check"></i><b>6.1.2</b> Classification du zooplancton</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="positionnement-multidimensionnel-mds.html"><a href="positionnement-multidimensionnel-mds.html"><i class="fa fa-check"></i><b>6.2</b> Positionnement multidimensionnel (MDS)</a><ul>
<li class="chapter" data-level="6.2.1" data-path="positionnement-multidimensionnel-mds.html"><a href="positionnement-multidimensionnel-mds.html#mds-simplifiee-sous-sciviewsr"><i class="fa fa-check"></i><b>6.2.1</b> MDS simplifiée sous SciViews::R</a></li>
<li class="chapter" data-level="6.2.2" data-path="positionnement-multidimensionnel-mds.html"><a href="positionnement-multidimensionnel-mds.html#mds-metrique-ou-pcoa"><i class="fa fa-check"></i><b>6.2.2</b> MDS métrique ou PCoA</a></li>
<li class="chapter" data-level="6.2.3" data-path="positionnement-multidimensionnel-mds.html"><a href="positionnement-multidimensionnel-mds.html#mds-non-metrique"><i class="fa fa-check"></i><b>6.2.3</b> MDS non métrique</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="cartes-auto-adaptatives-som.html"><a href="cartes-auto-adaptatives-som.html"><i class="fa fa-check"></i><b>6.3</b> Cartes auto-adaptatives (SOM)</a><ul>
<li class="chapter" data-level="6.3.1" data-path="cartes-auto-adaptatives-som.html"><a href="cartes-auto-adaptatives-som.html#som-sur-le-zooplancton"><i class="fa fa-check"></i><b>6.3.1</b> SOM sur le zooplancton</a></li>
<li class="chapter" data-level="6.3.2" data-path="cartes-auto-adaptatives-som.html"><a href="cartes-auto-adaptatives-som.html#interpretation-dun-som"><i class="fa fa-check"></i><b>6.3.2</b> Interprétation d’un SOM</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="acp-afc.html"><a href="acp-afc.html"><i class="fa fa-check"></i><b>7</b> ACP &amp; AFC</a><ul>
<li class="chapter" data-level="7.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html"><i class="fa fa-check"></i><b>7.1</b> Analyse en composantes principales</a><ul>
<li class="chapter" data-level="7.1.1" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#acp-dans-sciviewsr"><i class="fa fa-check"></i><b>7.1.1</b> ACP dans SciViews::R</a></li>
<li class="chapter" data-level="7.1.2" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#indiens-diabetiques"><i class="fa fa-check"></i><b>7.1.2</b> Indiens diabétiques</a></li>
<li class="chapter" data-level="7.1.3" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#biometrie-doursin"><i class="fa fa-check"></i><b>7.1.3</b> Biométrie d’oursin</a></li>
<li class="chapter" data-level="7.1.4" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#visualisation-de-donnees-quantitatives"><i class="fa fa-check"></i><b>7.1.4</b> Visualisation de données quantitatives</a></li>
<li class="chapter" data-level="7.1.5" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#acp-mecanisme"><i class="fa fa-check"></i><b>7.1.5</b> ACP : mécanisme</a></li>
<li class="chapter" data-level="7.1.6" data-path="analyse-en-composantes-principales.html"><a href="analyse-en-composantes-principales.html#calcul-matriciel-acp"><i class="fa fa-check"></i><b>7.1.6</b> Calcul matriciel ACP</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="analyse-factorielle-des-correspondances.html"><a href="analyse-factorielle-des-correspondances.html"><i class="fa fa-check"></i><b>7.2</b> Analyse factorielle des correspondances</a><ul>
<li class="chapter" data-level="7.2.1" data-path="analyse-factorielle-des-correspondances.html"><a href="analyse-factorielle-des-correspondances.html#afc-dans-sciviewsr"><i class="fa fa-check"></i><b>7.2.1</b> AFC dans SciViews::R</a></li>
<li class="chapter" data-level="7.2.2" data-path="analyse-factorielle-des-correspondances.html"><a href="analyse-factorielle-des-correspondances.html#enquete-sur-la-science"><i class="fa fa-check"></i><b>7.2.2</b> Enquête sur la science</a></li>
<li class="chapter" data-level="7.2.3" data-path="analyse-factorielle-des-correspondances.html"><a href="analyse-factorielle-des-correspondances.html#des-acariens-sinon-rien"><i class="fa fa-check"></i><b>7.2.3</b> Des acariens sinon rien</a></li>
<li class="chapter" data-level="7.2.4" data-path="analyse-factorielle-des-correspondances.html"><a href="analyse-factorielle-des-correspondances.html#principe-de-lafc"><i class="fa fa-check"></i><b>7.2.4</b> Principe de l’AFC</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html"><i class="fa fa-check"></i><b>7.3</b> Accès aux bases de données</a><ul>
<li class="chapter" data-level="7.3.1" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#installation-de-sqlite"><i class="fa fa-check"></i><b>7.3.1</b> Installation de SQLite</a></li>
<li class="chapter" data-level="7.3.2" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#base-de-donnees-en-memoire"><i class="fa fa-check"></i><b>7.3.2</b> Base de données en mémoire</a></li>
<li class="chapter" data-level="7.3.3" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#base-de-donnees-dans-un-fichier"><i class="fa fa-check"></i><b>7.3.3</b> Base de données dans un fichier</a></li>
<li class="chapter" data-level="7.3.4" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#driver-odbc-dans-rstudio"><i class="fa fa-check"></i><b>7.3.4</b> Driver ODBC dans RStudio</a></li>
<li class="chapter" data-level="7.3.5" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#utilisation-de-db-browser"><i class="fa fa-check"></i><b>7.3.5</b> Utilisation de DB Browser</a></li>
<li class="chapter" data-level="7.3.6" data-path="acces-aux-bases-de-donnees.html"><a href="acces-aux-bases-de-donnees.html#utilisation-de-dplyr"><i class="fa fa-check"></i><b>7.3.6</b> Utilisation de dplyr</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="afm.html"><a href="afm.html"><i class="fa fa-check"></i><b>8</b> AFM, biodiversité et Open Data</a><ul>
<li class="chapter" data-level="8.1" data-path="analyse-factorielle-multiple-afm.html"><a href="analyse-factorielle-multiple-afm.html"><i class="fa fa-check"></i><b>8.1</b> Analyse factorielle multiple (AFM)</a><ul>
<li class="chapter" data-level="8.1.1" data-path="analyse-factorielle-multiple-afm.html"><a href="analyse-factorielle-multiple-afm.html#afm-dans-sciviewsr"><i class="fa fa-check"></i><b>8.1.1</b> AFM dans SciViews::R</a></li>
<li class="chapter" data-level="8.1.2" data-path="analyse-factorielle-multiple-afm.html"><a href="analyse-factorielle-multiple-afm.html#plancton-en-mediterranee"><i class="fa fa-check"></i><b>8.1.2</b> Plancton en Méditerranée</a></li>
<li class="chapter" data-level="8.1.3" data-path="analyse-factorielle-multiple-afm.html"><a href="analyse-factorielle-multiple-afm.html#afm-avec-donnees-mixtes"><i class="fa fa-check"></i><b>8.1.3</b> AFM avec données mixtes</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="indices-de-biodiversite.html"><a href="indices-de-biodiversite.html"><i class="fa fa-check"></i><b>8.2</b> Indices de biodiversité</a><ul>
<li class="chapter" data-level="8.2.1" data-path="indices-de-biodiversite.html"><a href="indices-de-biodiversite.html#diversite-alpha"><i class="fa fa-check"></i><b>8.2.1</b> Diversité alpha</a></li>
<li class="chapter" data-level="8.2.2" data-path="indices-de-biodiversite.html"><a href="indices-de-biodiversite.html#diversite-beta"><i class="fa fa-check"></i><b>8.2.2</b> Diversité beta</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="open-data.html"><a href="open-data.html"><i class="fa fa-check"></i><b>8.3</b> Open Data</a><ul>
<li class="chapter" data-level="8.3.1" data-path="open-data.html"><a href="open-data.html#gestion-des-donnees"><i class="fa fa-check"></i><b>8.3.1</b> Gestion des données</a></li>
<li class="chapter" data-level="8.3.2" data-path="open-data.html"><a href="open-data.html#utilisation-de-donnees-ouvertes-open-data"><i class="fa fa-check"></i><b>8.3.2</b> Utilisation de données ouvertes (<em>Open Data</em>)</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="svbox.html"><a href="svbox.html"><i class="fa fa-check"></i><b>A</b> Installation de la SciViews Box</a><ul>
<li class="chapter" data-level="A.1" data-path="migration-des-projets.html"><a href="migration-des-projets.html"><i class="fa fa-check"></i><b>A.1</b> Migration des projets</a></li>
<li class="chapter" data-level="A.2" data-path="configuration-git-et-github.html"><a href="configuration-git-et-github.html"><i class="fa fa-check"></i><b>A.2</b> Configuration Git et Github</a><ul>
<li class="chapter" data-level="A.2.1" data-path="configuration-git-et-github.html"><a href="configuration-git-et-github.html#compte-github-dans-rstudio"><i class="fa fa-check"></i><b>A.2.1</b> Compte Github dans RStudio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>Références</a></li>
<li class="divider"></li>
<li><a href="https://wp.sciviews.org/sdd-umons2">Dernière version de ce cours</a></li>
<li><a href="https://wp.sciviews.org">Site Web du cours</a></li>
<li><a href="https://github.com/BioDataScience-Course">Site Github du cours</a></li>
<br/>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publié avec bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Science des données biologiques 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analyse-factorielle-des-correspondances" class="section level2">
<h2><span class="header-section-number">7.2</span> Analyse factorielle des correspondances</h2>
<p>Comme l’ACP s’intéresse à des corrélations linéaires entre variables quantitatives, elle n’est absolument pas utilisable pour traiter des variables qualitatives. L’<strong>Analyse Factorielle des Correspondances</strong> sera utile dans ce dernier cas (AFC, ou en anglais “Correspondence Analysis” ou CA).</p>
<div id="afc-dans-sciviewsr" class="section level3">
<h3><span class="header-section-number">7.2.1</span> AFC dans SciViews::R</h3>
<p>L’AFC utilises la fonction <code>ca()</code> du package <code>ca</code> dans <code>SciViews::R</code>, mais au stade actuel, tout le code nécessaire (en particulier pour réaliser les graphiques avec <code>chart()</code>) n’est pas encore complètement intégré dans les packages. Ainsi, vous pouvez copier-coller le code du chunk suivant au début de vos scripts ou dans un chunk de <code>setup</code> dans vos documents R Markdown/Notebook.</p>
<pre class="sourceCode r"><code class="sourceCode r">SciViews<span class="op">::</span><span class="kw">R</span>()
<span class="kw">library</span>(broom)

<span class="co"># Au lieu de MASS::corresp(, nf = 2), nous préférons ca::ca()</span>
ca &lt;-<span class="st"> </span>ca<span class="op">::</span>ca

scale_axes &lt;-<span class="st"> </span><span class="cf">function</span>(data, <span class="dt">aspect.ratio =</span> <span class="dv">1</span>) {
  range_x &lt;-<span class="st"> </span><span class="kw">range</span>(data[, <span class="dv">1</span>])
  span_x &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">max</span>(range_x) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(range_x))
  range_y &lt;-<span class="st"> </span><span class="kw">range</span>(data[, <span class="dv">2</span>])
  span_y &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">max</span>(range_y) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(range_y))
  <span class="cf">if</span> ((span_y <span class="op">/</span><span class="st"> </span>aspect.ratio) <span class="op">&gt;</span><span class="st"> </span>span_x) {
    <span class="co"># Adjust range_x</span>
    span_x_<span class="dv">2</span> &lt;-<span class="st"> </span>span_y <span class="op">/</span><span class="st"> </span>aspect.ratio <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
    range_x_mid &lt;-<span class="st"> </span><span class="kw">sum</span>(range_x) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
    range_x &lt;-<span class="st"> </span><span class="kw">c</span>(range_x_mid <span class="op">-</span><span class="st"> </span>span_x_<span class="dv">2</span>, range_x_mid <span class="op">+</span><span class="st"> </span>span_x_<span class="dv">2</span>)
  } <span class="cf">else</span> {
    <span class="co"># Adjust range_y</span>
    span_y_<span class="dv">2</span> &lt;-<span class="st"> </span>span_x <span class="op">*</span><span class="st"> </span>aspect.ratio <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
    range_y_mid &lt;-<span class="st"> </span><span class="kw">sum</span>(range_y) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
    range_y &lt;-<span class="st"> </span><span class="kw">c</span>(range_y_mid <span class="op">-</span><span class="st"> </span>span_y_<span class="dv">2</span>, range_y_mid <span class="op">+</span><span class="st"> </span>span_y_<span class="dv">2</span>)
  }
  <span class="kw">list</span>(<span class="dt">x =</span> range_x, <span class="dt">y =</span> range_y)
}

plot3d &lt;-<span class="st"> </span>rgl<span class="op">::</span>plot3d
plot3d.ca &lt;-<span class="st"> </span>ca<span class="op">:::</span>plot3d.ca

autoplot.ca &lt;-<span class="st"> </span><span class="cf">function</span>(object, <span class="dt">choices =</span> 1L<span class="op">:</span>2L,
<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;screeplot&quot;</span>, <span class="st">&quot;altscreeplot&quot;</span>, <span class="st">&quot;biplot&quot;</span>), <span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>,
<span class="dt">aspect.ratio =</span> <span class="dv">1</span>, <span class="dt">repel =</span> <span class="ot">FALSE</span>, ...) {
  type =<span class="st"> </span><span class="kw">match.arg</span>(type)

  res &lt;-<span class="st"> </span><span class="cf">switch</span>(type,
    <span class="dt">screeplot =</span> object <span class="op">%&gt;.%</span><span class="st"> </span><span class="co"># Classical screeplot</span>
<span class="st">      `</span><span class="dt">[[</span><span class="st">`</span>(., <span class="st">&quot;sv&quot;</span>) <span class="op">%&gt;.%</span>
<span class="st">      </span><span class="kw">tibble</span>(<span class="dt">Dimension =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(.), <span class="dt">sv =</span> .) <span class="op">%&gt;.%</span>
<span class="st">      </span><span class="kw">chart</span>(<span class="dt">data =</span> ., sv<span class="op">^</span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>Dimension) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_col</span>(<span class="dt">col =</span> col, <span class="dt">fill =</span> fill) <span class="op">+</span>
<span class="st">      </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Inertia&quot;</span>),

    <span class="dt">altscreeplot =</span> object <span class="op">%&gt;.%</span><span class="st"> </span><span class="co"># screeplot represented by dots and lines</span>
<span class="st">      `</span><span class="dt">[[</span><span class="st">`</span>(., <span class="st">&quot;sv&quot;</span>) <span class="op">%&gt;.%</span>
<span class="st">      </span><span class="kw">tibble</span>(<span class="dt">Dimension =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(.), <span class="dt">sv =</span> .) <span class="op">%&gt;.%</span>
<span class="st">      </span><span class="kw">chart</span>(<span class="dt">data =</span> ., sv<span class="op">^</span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span>Dimension) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_line</span>(<span class="dt">col =</span> col) <span class="op">+</span>
<span class="st">      </span><span class="kw">geom_point</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">fill =</span> col, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">stroke =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">      </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Inertia&quot;</span>),

    <span class="dt">biplot =</span> {
      <span class="co"># We want to use the function plot.ca(), but without plotting the base plot</span>
      <span class="co"># So, we place it in a specific environment where all base plot functions are</span>
      <span class="co"># fake and do nothing (we just want to collect points coordinates at the end)</span>
      env &lt;-<span class="st"> </span><span class="kw">new.env</span>()
      env<span class="op">$</span>plot_ca &lt;-<span class="st"> </span>ca<span class="op">:::</span>plot.ca
      <span class="kw">environment</span>(env<span class="op">$</span>plot_ca) &lt;-<span class="st"> </span>env
      env<span class="op">$</span>plot &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="ot">NULL</span>
      env<span class="op">$</span>box &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="ot">NULL</span>
      env<span class="op">$</span>abline &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="ot">NULL</span>
      env<span class="op">$</span>axis &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="ot">NULL</span>
      env<span class="op">$</span>par &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="ot">NULL</span>
      env<span class="op">$</span>points &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="ot">NULL</span>
      env<span class="op">$</span>lines &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="ot">NULL</span>
      env<span class="op">$</span>.arrows &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="ot">NULL</span>
      env<span class="op">$</span>text &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="ot">NULL</span>
      env<span class="op">$</span>strwidth &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="ot">NULL</span>
      env<span class="op">$</span>strheight &lt;-<span class="st"> </span><span class="cf">function</span>(...) <span class="ot">NULL</span>

      contribs &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;Dimension &quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(object<span class="op">$</span>sv), <span class="st">&quot; (&quot;</span>,
        <span class="kw">round</span>(object<span class="op">$</span>sv<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(object<span class="op">$</span>sv<span class="op">^</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="dv">1</span>), <span class="st">&quot;%)&quot;</span>)[choices]

      res &lt;-<span class="st"> </span>env<span class="op">$</span><span class="kw">plot_ca</span>(object, <span class="dt">dim =</span> choices, ...)

      rows &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(res<span class="op">$</span>rows)
      rows<span class="op">$</span>Type &lt;-<span class="st"> &quot;rows&quot;</span>
      rows<span class="op">$</span>Labels &lt;-<span class="st"> </span>object<span class="op">$</span>rownames
      cols &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(res<span class="op">$</span>cols)
      cols<span class="op">$</span>Type &lt;-<span class="st"> &quot;cols&quot;</span>
      cols<span class="op">$</span>Labels &lt;-<span class="st"> </span>object<span class="op">$</span>colnames
      res &lt;-<span class="st"> </span><span class="kw">bind_rows</span>(rows, cols)
      <span class="kw">names</span>(res) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;labels&quot;</span>)

      lims &lt;-<span class="st"> </span><span class="kw">scale_axes</span>(res, <span class="dt">aspect.ratio =</span> aspect.ratio)
      nudge &lt;-<span class="st"> </span>(lims<span class="op">$</span>x[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>lims<span class="op">$</span>x[<span class="dv">1</span>]) <span class="op">/</span><span class="st"> </span><span class="dv">100</span>

      res &lt;-<span class="st"> </span><span class="kw">chart</span>(<span class="dt">data =</span> res, y <span class="op">~</span><span class="st"> </span>x <span class="op">%col=%</span><span class="st"> </span>type <span class="op">%label=%</span><span class="st"> </span>labels) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">coord_fixed</span>(<span class="dt">ratio =</span> <span class="dv">1</span>, <span class="dt">xlim =</span> lims<span class="op">$</span>x, <span class="dt">ylim =</span> lims<span class="op">$</span>y, <span class="dt">expand =</span> <span class="ot">TRUE</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x =</span> contribs[<span class="dv">1</span>], <span class="dt">y =</span> contribs[<span class="dv">2</span>])

      <span class="cf">if</span> (<span class="kw">isTRUE</span>(repel)) {
        res &lt;-<span class="st"> </span>res <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>ggrepel<span class="op">::</span><span class="kw">geom_text_repel</span>()
      } <span class="cf">else</span> {<span class="co"># Use text</span>
        res &lt;-<span class="st"> </span>res <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">          </span><span class="kw">geom_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>, <span class="dt">vjust =</span> <span class="dv">0</span>, <span class="dt">nudge_x =</span> nudge, <span class="dt">nudge_y =</span> nudge)
      }
      res
    }
  )
  res
}
chart.ca &lt;-<span class="st"> </span><span class="cf">function</span>(data, <span class="dt">choices =</span> 1L<span class="op">:</span>2L, ...,
<span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;screeplot&quot;</span>, <span class="st">&quot;altscreeplot&quot;</span>, <span class="st">&quot;boiplot&quot;</span>), <span class="dt">env =</span> <span class="kw">parent.frame</span>())
  <span class="kw">autoplot.ca</span>(data, <span class="dt">choices =</span> choices, ..., <span class="dt">type =</span> type, <span class="dt">env =</span> env)
<span class="kw">class</span>(chart.ca) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;function&quot;</span>, <span class="st">&quot;subsettable_type&quot;</span>)</code></pre>
</div>
<div id="enquete-sur-la-science" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Enquête sur la science</h3>
<p>L’idée de départ de l’AFC est de pouvoir travailler sur des données qualitatives en les transformant en variables quantitatives via une astuce de calcul, et ensuite de réaliser une ACP sur ce tableau quantitatif pour en représenter l’information visuellement sur une carte. Les enquêtes (mais pas seulement) génèrent souvent des quantités importantes de variables qualitatives qu’il faut ensuite analyser. En effet, des sondage proposent la plupart du temps d’évaluer une question sur une échelle de plusieurs niveaux du genre “tout-à-fait d’accord”, “d’accord”, “pas d’accord”, “pas du tout d’accord”, ce qui donnerait une variable facteur à quatre niveaux ordonnés.</p>
<p>Une grande enquête mondiale a été réalisée en 1993 pour déterminer (entre autre) ce que la population pense de la science en général. Quatre questions sont posées (section 4 de <a href="https://dbk.gesis.org/dbksearch/download.asp?db=E&amp;id=7987">ce questionnaire</a>, voir aussi <a href="https://dbk.gesis.org/dbksearch/sdesc2.asp?no=2450&amp;search=issp%201993&amp;search2=&amp;field=all&amp;field2=&amp;DB=e&amp;tab=0&amp;notabs=&amp;nf=1&amp;af=&amp;ll=10">ici</a>) :</p>
<p>A. Les gens croient trop souvent à la science, et pas assez aux sentiments et à la foi</p>
<p>B. En général, la science moderne fait plus de mal que de bien</p>
<p>C. Tout changement dans la nature apporté par les êtres humains risque d’empirer les choses</p>
<p>D. La science moderne va résoudre nos problèmes relatifs à l’environement sans faire de grands changements à notre mode de vie</p>
<p>Les réponses possibles sont : 1 = tout-à-fait d’accord à 5 = pas du tout d’accord. Le jeu de données <code>wg93</code> du package <code>ca</code> reprend les réponses données par les allemands de l’ouest à ces questions. De plus, les caractéristiques suivantes des répondants sont enregistrées :</p>
<ul>
<li>le sexe (1 = homme, 2 = femme),</li>
<li>l’âge (1 = 18-24, 2 = 25-34, 3 = 35-44, 4 = 45-54, 5 = 55-64, 6 = 65+)</li>
<li>le niveau d’éducation (1 = primaire, 2 = second. partim, 3 = secondaire, 4 = univ. partim, 5 = univ. cycle 1, 6 = univ. cycle 2+)</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r">wg &lt;-<span class="st"> </span><span class="kw">read</span>(<span class="st">&quot;wg93&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;ca&quot;</span>)
wg</code></pre>
<pre><code># # A tibble: 871 x 7
#    A     B     C     D     sex   age   edu  
#    &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;
#  1 2     3     4     3     2     2     3    
#  2 3     4     2     3     1     3     4    
#  3 2     3     2     4     2     3     2    
#  4 2     2     2     2     1     2     3    
#  5 3     3     3     3     1     5     2    
#  6 3     4     4     5     1     3     2    
#  7 3     4     2     4     2     5     2    
#  8 3     4     4     2     1     3     3    
#  9 3     2     2     1     1     3     2    
# 10 3     3     2     2     1     3     2    
# # … with 861 more rows</code></pre>
<p>Ceci est un tableau cas par variables avec sept variables facteurs et 871 cas. Nous commençons par réencoder les niveaux des variables pour plus de clarté :</p>
<pre class="sourceCode r"><code class="sourceCode r">wg <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">mutate</span>(.,
    <span class="dt">A =</span> <span class="kw">recode</span>(A, <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;++&quot;</span>, <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> &quot;+&quot;</span>, <span class="st">`</span><span class="dt">3</span><span class="st">`</span> =<span class="st"> &quot;0&quot;</span>, <span class="st">`</span><span class="dt">4</span><span class="st">`</span> =<span class="st"> &quot;-&quot;</span>, <span class="st">`</span><span class="dt">5</span><span class="st">`</span> =<span class="st"> &quot;--&quot;</span>),
    <span class="dt">B =</span> <span class="kw">recode</span>(B, <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;++&quot;</span>, <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> &quot;+&quot;</span>, <span class="st">`</span><span class="dt">3</span><span class="st">`</span> =<span class="st"> &quot;0&quot;</span>, <span class="st">`</span><span class="dt">4</span><span class="st">`</span> =<span class="st"> &quot;-&quot;</span>, <span class="st">`</span><span class="dt">5</span><span class="st">`</span> =<span class="st"> &quot;--&quot;</span>),
    <span class="dt">C =</span> <span class="kw">recode</span>(C, <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;++&quot;</span>, <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> &quot;+&quot;</span>, <span class="st">`</span><span class="dt">3</span><span class="st">`</span> =<span class="st"> &quot;0&quot;</span>, <span class="st">`</span><span class="dt">4</span><span class="st">`</span> =<span class="st"> &quot;-&quot;</span>, <span class="st">`</span><span class="dt">5</span><span class="st">`</span> =<span class="st"> &quot;--&quot;</span>),
    <span class="dt">D =</span> <span class="kw">recode</span>(D, <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;++&quot;</span>, <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> &quot;+&quot;</span>, <span class="st">`</span><span class="dt">3</span><span class="st">`</span> =<span class="st"> &quot;0&quot;</span>, <span class="st">`</span><span class="dt">4</span><span class="st">`</span> =<span class="st"> &quot;-&quot;</span>, <span class="st">`</span><span class="dt">5</span><span class="st">`</span> =<span class="st"> &quot;--&quot;</span>),
    <span class="dt">sex =</span> <span class="kw">recode</span>(sex, <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;H&quot;</span>, <span class="st">`</span><span class="dt">2</span><span class="st">`</span>=<span class="st"> &quot;F&quot;</span>),
    <span class="dt">age =</span> <span class="kw">recode</span>(age, <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;18-24&quot;</span>, <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> &quot;25-34&quot;</span>, <span class="st">`</span><span class="dt">3</span><span class="st">`</span> =<span class="st"> &quot;35-44&quot;</span>,
      <span class="st">`</span><span class="dt">4</span><span class="st">`</span> =<span class="st"> &quot;45-54&quot;</span>, <span class="st">`</span><span class="dt">5</span><span class="st">`</span> =<span class="st"> &quot;55-64&quot;</span>, <span class="st">`</span><span class="dt">6</span><span class="st">`</span> =<span class="st"> &quot;65+&quot;</span>),
    <span class="dt">edu =</span> <span class="kw">recode</span>(edu, <span class="st">`</span><span class="dt">1</span><span class="st">`</span> =<span class="st"> &quot;primaire&quot;</span>, <span class="st">`</span><span class="dt">2</span><span class="st">`</span> =<span class="st"> &quot;sec. part&quot;</span>, <span class="st">`</span><span class="dt">3</span><span class="st">`</span> =<span class="st"> &quot;secondaire&quot;</span>,
      <span class="st">`</span><span class="dt">4</span><span class="st">`</span> =<span class="st"> &quot;univ. part&quot;</span>, <span class="st">`</span><span class="dt">5</span><span class="st">`</span> =<span class="st"> &quot;univ. cycle 1&quot;</span>, <span class="st">`</span><span class="dt">6</span><span class="st">`</span> =<span class="st"> &quot;univ. cycle 2&quot;</span>)
  ) -&gt;<span class="st"> </span>wg
wg</code></pre>
<pre><code># # A tibble: 871 x 7
#    A     B     C     D     sex   age   edu       
#    &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;     
#  1 +     0     -     0     F     25-34 secondaire
#  2 0     -     +     0     H     35-44 univ. part
#  3 +     0     +     -     F     35-44 sec. part 
#  4 +     +     +     +     H     25-34 secondaire
#  5 0     0     0     0     H     55-64 sec. part 
#  6 0     -     -     --    H     35-44 sec. part 
#  7 0     -     +     -     F     55-64 sec. part 
#  8 0     -     -     +     H     35-44 secondaire
#  9 0     +     +     ++    H     35-44 sec. part 
# 10 0     0     +     +     H     35-44 sec. part 
# # … with 861 more rows</code></pre>
<p>Par exemple, si nous nous posons la question de l’impact de l’éducation sur l’impression que la science est néfaste (question B), nous pourrons faire l’analyse suivante :</p>
<ul>
<li><strong>Étape 1 :</strong> calcul du tableau de contingence à double entrée croisant les réponses à la question B avec le niveau d’éducation des répondants :</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(wg<span class="op">$</span>B, wg<span class="op">$</span>edu)</code></pre>
<pre><code>#     
#      primaire sec. part secondaire univ. part univ. cycle 1 univ. cycle 2
#   ++        6        34         19          6             4             2
#   +        10        93         47         12             5             7
#   0        11        95         55         18            11            15
#   -         7       112         82         37            16            27
#   --        4        44         39         21            13            19</code></pre>
<ul>
<li><strong>Étape 2 :</strong> test de Chi<sup>2</sup> d’indépendance, voir <a href="http://biodatascience-course.sciviews.org/sdd-umons/test-dhypothese.html#test-chi2-dindependance">section 8.2 du cours de SDD I</a>. L’hypothèse nulle du test est quel les deux variables sont indépendantes l’une de l’autre. L’hypothèse alternative est qu’une dépendance existe. Si la réponse aux questions est indépendante du niveau d’éducation (pas de rejet de H<sub>0</sub>), notre analyse est terminée. Sinon, il faut approfondir… Choisissons notre seuil <span class="math inline">\(\alpha\)</span> à 5% avant de réaliser notre test.</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">chisq.test</span>(wg<span class="op">$</span>B, wg<span class="op">$</span>edu)</code></pre>
<pre><code># Warning in chisq.test(wg$B, wg$edu): Chi-squared approximation may be
# incorrect</code></pre>
<pre><code># 
#   Pearson&#39;s Chi-squared test
# 
# data:  wg$B and wg$edu
# X-squared = 42.764, df = 20, p-value = 0.002196</code></pre>
<p>L’avertissement nous prévient qu’une approximation a du être réalisée, mais le test reste utilisable si la valeur est loin du seuil <span class="math inline">\(/alpha\)</span>. La valeur <em>p</em> de 0,2% est très inférieure à <span class="math inline">\(\alpha\)</span>. Nous rejettons H<sub>0</sub>. Il y a dépendance entre le niveau d’éducation et la réponse à la question B. OK, mais comment se fait cette dépendance ? C’est ici que l’AFC nous vient en aide.</p>
<p>-<strong>Étape 3 :</strong> Si l’hypothèse nulle est rejettée, il faut analyser plus en profondeur. L’AFC va présenter la dépendance de manière claire. La fonction <code>ca()</code> accepte un jeu de données dans l’argument <code>data =</code> et une formule qui spécifie dans le terme de droite les deux variables à croiser séparées par un signe + (<code>~ fact1 + fact2</code>). Donc :</p>
<pre class="sourceCode r"><code class="sourceCode r">wg_b_edu &lt;-<span class="st"> </span><span class="kw">ca</span>(<span class="dt">data =</span> wg, <span class="op">~</span><span class="st"> </span>B <span class="op">+</span><span class="st"> </span>edu)
wg_b_edu</code></pre>
<pre><code># 
#  Principal inertias (eigenvalues):
#            1        2        3        4    
# Value      0.043989 0.004191 0.000914 4e-06
# Percentage 89.59%   8.54%    1.86%    0.01%
# 
# 
#  Rows:
#                ++         +         0        -        --
# Mass     0.081515  0.199770  0.235362 0.322618  0.160735
# ChiDist  0.286891  0.274685  0.095627 0.141176  0.341388
# Inertia  0.006709  0.015073  0.002152 0.006430  0.018733
# Dim. 1  -1.140162 -1.293374 -0.406059 0.591115  1.593838
# Dim. 2  -2.211930  0.641674 -0.409771 0.976000 -1.034695
# 
# 
#  Columns:
#          primaire sec. part secondaire univ. part univ. cycle 1
# Mass     0.043628  0.433984   0.277842   0.107922      0.056257
# ChiDist  0.427367  0.164446   0.036882   0.279471      0.341163
# Inertia  0.007968  0.011736   0.000378   0.008429      0.006548
# Dim. 1  -1.722505 -0.773101   0.115183   1.302120      1.428782
# Dim. 2  -3.523982  0.381160   0.336612   0.235984     -2.516238
#         univ. cycle 2
# Mass         0.080367
# ChiDist      0.417941
# Inertia      0.014038
# Dim. 1       1.962905
# Dim. 2       0.135512</code></pre>
<p>Nous retrouvons les valeurs propres (<code>eigenvalues</code>) qui représentent l’inertie exprimée sur les différents axes, avec le pourcentage juste en dessous. Les deux tableaux suivants détaillent les calculs. Il n’est pas indispensable de comprendre tout ce qui s’y trouve, mais notez que les composantes du calcul du Chi<sup>2</sup> pour chaque niveau des variables sont reprises à la ligne <code>ChiDist</code>. Nous y reviendrons. La méthode <code>summary()</code> ainsi que le graphique des éboulis via <code>chart$scree()</code> nous donnent une information plus claire sur la contribution de la variabilité totale sur les différents axes. Cela nous aide à décider si le plan réduit aux deux premiers axes que nous utiliserons ensuite est adéquat ou non (pourcentage suffisant = données bien représentées dans ce plan).</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(wg_b_edu, <span class="dt">scree =</span> <span class="ot">TRUE</span>, <span class="dt">rows =</span> <span class="ot">FALSE</span>, <span class="dt">columns =</span> <span class="ot">FALSE</span>)</code></pre>
<pre><code># 
# Principal inertias (eigenvalues):
# 
#  dim    value      %   cum%   scree plot               
#  1      0.043989  89.6  89.6  **********************   
#  2      0.004191   8.5  98.1  **                       
#  3      0.000914   1.9 100.0                           
#  4      4e-06000   0.0 100.0                           
#         -------- -----                                 
#  Total: 0.049097 100.0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">chart<span class="op">$</span><span class="kw">scree</span>(wg_b_edu)</code></pre>
<p><img src="07-acp-afc_files/figure-html/unnamed-chunk-62-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Ici, les deux premiers axes cumulent plus de 98% de la variation totale. Nous pouvons donc continuer en toute confiance. Le <strong>biplot</strong> va ici projetter les individus sur la carte (les individus étant en fait les différents niveaux des deux variables, obtenus après réalisation de deux ACP, l’une sur les colonnes et l’autre sur les lignes). Les deux groupes sont représentés par des couleurs différentes, mais sur une même carte. C’erst la fonction <code>chart$biplot()</code> qui réalise ce graphique.</p>
<pre class="sourceCode r"><code class="sourceCode r">chart<span class="op">$</span><span class="kw">biplot</span>(wg_b_edu, <span class="dt">choices =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</code></pre>
<p><img src="07-acp-afc_files/figure-html/unnamed-chunk-63-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>L’interprétation se fait d’abord sur les points d’une couleur (niveau de la première variable), puis sur ceux de l’autre (niveaux de la seconde variable), et enfin, conjointement. Voici ce que cela donne ici :</p>
<ul>
<li><p>Les niveaux d’éducation en rouge sont globalement représentés essentiellement de gauche à droite dans un ordre croissant de “études primaires” jusqu’à “études universitaires de 2<sup>éme</sup> cycle ou plus”.</p></li>
<li><p>Les réponses à la question B (en bleu turquoise) sont également rangés globalement de gauche à droite (avec une légère inversion entre <code>+</code> et <code>++</code>) depuis ceux qui sont tout-à-fait d’accord que la science moderne est néfaste à la gauche jusqu’à ceux qui ne le sont pas du tout à la droite.</p></li>
<li><p>Conjointement, on va comparer les points rouges et les bleus et regarder ceux qui se situent dans une direction similaire par rapport au centre d’inertie à la coordonnée {0, 0} matérialisée par la croix grise<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a>. Ainsi, nous constatons que ceux qui ont le niveau éducatif le plus faible (niveau primaire) ont globalement plutôt répondu qu’ils sont tout-à-fait d’accord (<code>++</code>), alors qu’à l’opposé, les universitaires ne sont pas du tous d’accord avec l’affirmation (<code>--</code>).</p></li>
</ul>
<p>L’essentiel se lit ici effectivement sur un seul axe (dimension 1) qui capture environ 90% de la variation totale. Le second axe vient moduler légèrement ce classement avec 8,5% de variabilité, mais sans tout bouleverser.</p>
<p>Ici la lecture de la carte générée par l’AFC est limpide… Et manifestement, nous pouvions légitimement conclure à l’époque qu’un effort éducatif et d’information était nécessaire auprès de la population la moins éduquée pour leur faire prendre conscience de l’intérêt de la science moderne (à moins que cette dernière remarque ne soit un parti pris… d’un universtaire :-).</p>
</div>
<div id="des-acariens-sinon-rien" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Des acariens sinon rien</h3>
<p>Un deuxième exemple illustre une utilisation légèrement différente de l’AFC. Il s’agit des tableaux de type “espèces par stations”. Ces tableaux contiennent différentes espèces ou autres groupes taxonomiques dénombrés dans plusieurs échantillons prélevés à des stations différentes. Le dénombrement des espèces peut être quantitatif (nombre d’individus observés par unité de surface ou de volume), semi-quantitatif (peu, moyen, beaucoup), ou même binaire (présence ou absence de l’espèce). Ces tableaux sont assimilables, en réalité, à des tableaux de contingence à double entrée qui croisent deux variables qualitatives “espèce” et “station”. C’est comme si la première étape avait déjà été réalisée dans l’analyse précédente du jeu de données <code>wg</code>.</p>
<p>Naturellement, comme il ne s’agit pas réellement d’un tableau de contingence, nous ne réaliserons pas le test Chi<sup>2</sup> d’indépendance ici, et nous passerons directement à l’étape de l’AFC. L’exemple choisi concerne des populations d’acariens dans de la litière (acarien se dit “mite” en anglais, d’où le nom du jeu de données issu du package <code>vegan</code>).</p>
<pre class="sourceCode r"><code class="sourceCode r">mite &lt;-<span class="st"> </span><span class="kw">read</span>(<span class="st">&quot;mite&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;vegan&quot;</span>)
skimr<span class="op">::</span><span class="kw">skim</span>(mite)</code></pre>
<pre><code># Skim summary statistics
#  n obs: 70 
#  n variables: 35 
# 
# ── Variable type:integer ──────────────────────────────────────────────────────────────────────────────────────────────
#  variable missing complete  n  mean    sd p0  p25  p50   p75 p100     hist
#    Brachy       0       70 70  8.73 10.08  0 3     4.5 11.75   42 ▇▂▁▂▁▁▁▁
#  Ceratoz1       0       70 70  1.29  1.46  0 0     1    2       5 ▇▆▁▃▁▁▁▁
#  Ceratoz3       0       70 70  1.3   2.2   0 0     0    2       9 ▇▁▁▁▁▁▁▁
#  Eupelops       0       70 70  0.64  0.99  0 0     0    1       4 ▇▃▁▁▁▁▁▁
#      FSET       0       70 70  1.86  3.18  0 0     0    2      12 ▇▂▁▁▁▁▁▁
#  Galumna1       0       70 70  0.96  1.73  0 0     0    1       8 ▇▁▁▁▁▁▁▁
#      HMIN       0       70 70  4.91  8.47  0 0     0    4.75   36 ▇▁▁▁▁▁▁▁
#     HMIN2       0       70 70  1.96  3.92  0 0     0    2.75   20 ▇▂▁▁▁▁▁▁
#      HPAV       0       70 70  8.51  7.56  0 4     6.5 12      37 ▇▇▃▃▁▁▁▁
#      HRUF       0       70 70  0.23  0.62  0 0     0    0       3 ▇▁▁▁▁▁▁▁
#      LCIL       0       70 70 35.26 88.85  0 1.25 13   44     723 ▇▁▁▁▁▁▁▁
#  Lepidzts       0       70 70  0.17  0.54  0 0     0    0       3 ▇▁▁▁▁▁▁▁
#      LRUG       0       70 70 10.43 12.66  0 0     4.5 17.75   57 ▇▂▂▁▁▁▁▁
#      MEGR       0       70 70  2.19  3.62  0 0     1    3      17 ▇▂▁▁▁▁▁▁
#  Miniglmn       0       70 70  0.24  0.79  0 0     0    0       5 ▇▁▁▁▁▁▁▁
#      MPRO       0       70 70  0.16  0.47  0 0     0    0       2 ▇▁▁▁▁▁▁▁
#      NCOR       0       70 70  1.13  1.65  0 0     0.5  1.75    7 ▇▃▂▂▁▁▁▁
#      NPRA       0       70 70  1.89  2.37  0 0     1    2.75   10 ▇▂▂▁▁▁▁▁
#      ONOV       0       70 70 17.27 18.05  0 5    10.5 24.25   73 ▇▃▂▁▁▁▁▁
#  Oppiminu       0       70 70  1.11  1.84  0 0     0    1.75    9 ▇▁▁▁▁▁▁▁
#  Oribatl1       0       70 70  1.89  3.43  0 0     0    2.75   17 ▇▁▁▁▁▁▁▁
#      PHTH       0       70 70  1.27  2.17  0 0     0    2       8 ▇▁▁▁▁▁▁▁
#     PLAG2       0       70 70  0.8   1.79  0 0     0    1       9 ▇▁▁▁▁▁▁▁
#      PPEL       0       70 70  0.17  0.54  0 0     0    0       3 ▇▁▁▁▁▁▁▁
#   Protopl       0       70 70  0.37  1.61  0 0     0    0      13 ▇▁▁▁▁▁▁▁
#      PWIL       0       70 70  1.09  1.71  0 0     0    1       8 ▇▁▁▁▁▁▁▁
#      RARD       0       70 70  1.21  2.78  0 0     0    1      13 ▇▂▁▁▁▁▁▁
#      SLAT       0       70 70  0.4   1.23  0 0     0    0       8 ▇▁▁▁▁▁▁▁
#      SSTR       0       70 70  0.31  0.97  0 0     0    0       6 ▇▁▁▁▁▁▁▁
#  Stgncrs2       0       70 70  0.73  1.83  0 0     0    0       9 ▇▁▁▁▁▁▁▁
#      SUCT       0       70 70 16.96 13.89  0 7.25 13.5 24      63 ▇▇▆▅▂▁▁▁
#  Trhypch1       0       70 70  2.61  6.14  0 0     0    2      29 ▇▁▁▁▁▁▁▁
#  Trimalc2       0       70 70  2.07  5.79  0 0     0    0      33 ▇▁▁▁▁▁▁▁
#      TVEL       0       70 70  9.06 10.93  0 0     3   19      42 ▇▁▁▂▁▁▁▁
#      TVIE       0       70 70  0.83  1.47  0 0     0    1       7 ▇▁▁▁▁▁▁▁</code></pre>
<p>35 espèces d’acariens sont dénombrés en 70 stations différentes, et il n’y a aucunes valeurs manquantes. Comme il ne peut y avoir aucun total de ligne ou de colonne égal à zéro pour le calcul des Chi<sup>2</sup> (sinon, on aurait une division par zéro), nous vérifions cela de la façon suivante :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rowSums</span>(mite)</code></pre>
<pre><code>#  [1] 140 268 186 286 199 209 162 126 123 166 216 213 177 269 100  97  90
# [18] 118 118 184 117 172  81  80 123 120 173 111 111  96 130  93 136 194
# [35] 111 133 139 189  94 157  81 140 148  60 158 154 121 113 107 148  91
# [52] 112 145  49  58 108   8 121  90 127  42  13  86  88 112 116 781 111
# [69] 184 121</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colSums</span>(mite)</code></pre>
<pre><code>#   Brachy     PHTH     HPAV     RARD     SSTR  Protopl     MEGR     MPRO 
#      611       89      596       85       22       26      153       11 
#     TVIE     HMIN    HMIN2     NPRA     TVEL     ONOV     SUCT     LCIL 
#       58      344      137      132      634     1209     1187     2468 
# Oribatl1 Ceratoz1     PWIL Galumna1 Stgncrs2     HRUF Trhypch1     PPEL 
#      132       90       76       67       51       16      183       12 
#     NCOR     SLAT     FSET Lepidzts Eupelops Miniglmn     LRUG    PLAG2 
#       79       28      130       12       45       17      730       56 
# Ceratoz3 Oppiminu Trimalc2 
#       91       78      145</code></pre>
<p>De plus, l’AFC est très sensible à la présence de valeurs extrêmes. Il faut être particulièrement attentif à ne pas avoir trop de disparité, surtout en présence d’espèces très abondantes <em>versus</em> d’autres très rares. Si quelques échantillons contiennent une quantité particulièrement large d’items, cela peut aussi être problématique. Pour des dénombrements ou du semi-quantitatif à plus d’une dizaine de niveaux, la boite de dispersion parallèle est un bon graphique, mais nous devons tronsformer le tableau de données en format long avec <code>gather()</code> pour pouvoir le faire, et ensuite, nous présentons les espèces sur l’axe des ordonnées avec <code>coord_flip()</code> :</p>
<pre class="sourceCode r"><code class="sourceCode r">mite <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">gather</span>(., <span class="dt">key =</span> <span class="st">&quot;species&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;n&quot;</span>) <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">chart</span>(., n <span class="op">~</span><span class="st"> </span>species) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre>
<p><img src="07-acp-afc_files/figure-html/unnamed-chunk-66-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Aïe ! Nous avons ici une magnifique valeur extrême, ainsi que des différences trop nettes entre les espèces les plus abondantes et les plus rares. Nous devons y remédier avant de faire notre AFC. Deux solutions sont possibles :</p>
<ol style="list-style-type: decimal">
<li>Soit nous dégradons l’information vers du semi-quantitatif en définissant des niveaux d’abondance, du genre 0, 1-10, 10-20, 20-30, 31+. Nous pouvons réaliser cela avec la fonction <code>cut()</code> illustrée ici sur un exemple fictif.</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">sample &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="dv">500</span>, <span class="dv">25</span>, <span class="dv">5</span>)
<span class="kw">cut</span>(sample, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="ot">Inf</span>))</code></pre>
<pre><code># [1] (-1,0]   (10,20]  (30,Inf] (20,30]  (0,10]  
# Levels: (-1,0] (0,10] (10,20] (20,30] (30,Inf]</code></pre>
<p>Nous voyons que <code>cut()</code> a ici remplacé nos données quantitatives dans <code>sample()</code> en une variable qualitative à cinq niveaux clairement libellés. Notez l’astuce du groupe <code>(-1,0]</code> pour capturer les valeurs nulles dans un groupe séparé.</p>
<ol start="2" style="list-style-type: decimal">
<li>Autre solution, nous transformons les données pour réduire l’écart entre les extrêmes. Typiquement, une transformation <span class="math inline">\(log(x + 1)\)</span> est efficace pour cela, et fonctionne bien en présence de valeurs nulles aussi. Nous utiliserons cette dernière technique pour notre jeu de données <code>mite</code>. Enfin, nous nous assurons que les station sont bien numérotées de 1 à 70 en lignes (<code>rownames()</code>).</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">mite2 &lt;-<span class="st"> </span><span class="kw">log1p</span>(<span class="kw">as.data.frame</span>(mite))
<span class="co"># Ajouter le numéro des stations explicitement</span>
<span class="kw">rownames</span>(mite2) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mite2)</code></pre>
<p>Le graphique boite de dispersion parallèle montre plus d’homogénéité maintenant :</p>
<pre class="sourceCode r"><code class="sourceCode r">mite2 <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">gather</span>(., <span class="dt">key =</span> <span class="st">&quot;species&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;log_n_1&quot;</span>) <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">chart</span>(., log_n_<span class="dv">1</span> <span class="op">~</span><span class="st"> </span>species) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</code></pre>
<p><img src="07-acp-afc_files/figure-html/unnamed-chunk-69-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>A noter que ce type de graphique ne convient pas pour les données semi-quantitatives ou qualitatives. Nous pouvons réaliser le graphique suivant à la place dans ce cas pour visualiser la distribution des espèces dans les différentes stations (qui fonctionne aussi en quantitatif) :</p>
<pre class="sourceCode r"><code class="sourceCode r">mite2 <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">gather</span>(., <span class="dt">key =</span> <span class="st">&quot;species&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;n&quot;</span>) <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">mutate</span>(., <span class="dt">station =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mite), <span class="kw">ncol</span>(mite))) <span class="op">%&gt;.%</span>
<span class="st">  </span><span class="kw">chart</span>(., species <span class="op">~</span><span class="st"> </span>station <span class="op">%fill=%</span><span class="st"> </span>n) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_raster</span>()</code></pre>
<p><img src="07-acp-afc_files/figure-html/unnamed-chunk-70-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Maintenant que nos données sont vérifiées, nettoyées (phase de préparation), et décrites correctement (phase descriptive), nous pouvons réaliser notre AFC et explorer les particularités de ce jeu de données en vue d’une étude plus approfondie ultérieure (phase exploratoire). L’utilisation de <code>ca()</code> sur un tableau de type contingence à double entrée déjà prêt est ultra-simple. Il suffit de fournir le tableau en question comme seul argument à la fonction.</p>
<pre class="sourceCode r"><code class="sourceCode r">mite2_ca &lt;-<span class="st"> </span><span class="kw">ca</span>(mite2)</code></pre>
<p>Examinons la variabilité sur les différents axes, numériquement et à l’aide du graphe des éboulis :</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(mite2_ca, <span class="dt">scree =</span> <span class="ot">TRUE</span>, <span class="dt">rows =</span> <span class="ot">FALSE</span>, <span class="dt">columns =</span> <span class="ot">FALSE</span>)</code></pre>
<pre><code># 
# Principal inertias (eigenvalues):
# 
#  dim    value      %   cum%   scree plot               
#  1      0.366209  31.5  31.5  ********                 
#  2      0.132783  11.4  42.9  ***                      
#  3      0.072315   6.2  49.1  **                       
#  4      0.065787   5.7  54.7  *                        
#  5      0.055872   4.8  59.5  *                        
#  6      0.048122   4.1  63.7  *                        
#  7      0.041834   3.6  67.3  *                        
#  8      0.039072   3.4  70.6  *                        
#  9      0.032183   2.8  73.4  *                        
#  10     0.031300   2.7  76.1  *                        
#  11     0.028809   2.5  78.6  *                        
#  12     0.026949   2.3  80.9  *                        
#  13     0.024701   2.1  83.0  *                        
#  14     0.022729   2.0  84.9                           
#  15     0.020618   1.8  86.7                           
#  16     0.018029   1.5  88.3                           
#  17     0.016836   1.4  89.7                           
#  18     0.014850   1.3  91.0                           
#  19     0.014217   1.2  92.2                           
#  20     0.012553   1.1  93.3                           
#  21     0.010879   0.9  94.2                           
#  22     0.010412   0.9  95.1                           
#  23     0.009703   0.8  96.0                           
#  24     0.008187   0.7  96.7                           
#  25     0.007294   0.6  97.3                           
#  26     0.006689   0.6  97.9                           
#  27     0.005343   0.5  98.3                           
#  28     0.004576   0.4  98.7                           
#  29     0.004020   0.3  99.1                           
#  30     0.003828   0.3  99.4                           
#  31     0.002732   0.2  99.6                           
#  32     0.001955   0.2  99.8                           
#  33     0.001656   0.1  99.9                           
#  34     0.000776   0.1 100.0                           
#         -------- -----                                 
#  Total: 1.163821 100.0</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">chart<span class="op">$</span><span class="kw">scree</span>(mite2_ca, <span class="dt">fill =</span> <span class="st">&quot;cornsilk&quot;</span>)</code></pre>
<p><img src="07-acp-afc_files/figure-html/unnamed-chunk-73-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>La variabilité décroit rapidement sur les deux premiers axes, et ensuite plus lentement. Les deux premières dimensions ne capturent qu’environ 43% de la variabilité totale. Toutefois, la variation moins brutale par après justifie de ne garder que deux axes. Malgré la représentativité relativement faible dans ce plan, nous verrons que l’AFC reste interprétable et peut fournir des informations utiles, même dans ce cas. Voici la carte (biplot) :</p>
<pre class="sourceCode r"><code class="sourceCode r">chart<span class="op">$</span><span class="kw">biplot</span>(mite2_ca, <span class="dt">choices =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</code></pre>
<p><img src="07-acp-afc_files/figure-html/unnamed-chunk-74-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Nous observons une forme en fer à cheval de la distribution des points. Attention ! Ceci est un artéfact lié au fait que la distance du Chi<sup>2</sup> a tendance à rapprocher les extrêmes (“qui se ressemblent dans la différence”, en quelque sorte) alors que notre souhait aurait plutôt été de les placer aux extrémités du graphique. Il faut donc analyser les données comme une transition progressive d’un état A vers un état B le long de la forme en fer à cheval.</p>
<p>Lorsqu’il y a beaucoup de points, ce graphique tend à être très encombré et illisible. L’argument <code>repel = TRUE</code> vient parfois aider en allant placer les labels de telle façon qu’ils se chevauchent le moins possible. Par contre, la forme du nuage de point est du coup un peu moins visible.</p>
<pre class="sourceCode r"><code class="sourceCode r">chart<span class="op">$</span><span class="kw">biplot</span>(mite2_ca, <span class="dt">choices =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">repel =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="07-acp-afc_files/figure-html/unnamed-chunk-75-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Nous vous laissons le soin d’effectuer l’analyse complète des points bleus (stations) entre eux, ensuite les points rouges (espèces) entre eux et enfin, conjointement. Notez les stations 44, 59, 65 et 67 qui se détachent et qui sont caractérisées par des espèces qu’on trouve préférentiellement là-bas : <code>Trhypch1</code> et <code>Trimalc2</code>. Les espèces et station proches du centre d’inertie, au contraire, ne montrent aucune particularité.</p>
</div>
<div id="principe-de-lafc" class="section level3">
<h3><span class="header-section-number">7.2.4</span> Principe de l’AFC</h3>
<p>Maintenant que nous avons découvert la façon de réaliser et d’interpréter une AFC, il est temps d’en comprendre les rouages. Rappelez-vous que la distance du Chi<sup>2</sup> quantifie l’écart entre des effectifs observés <span class="math inline">\(a_i\)</span> et des effectifs théoriques <span class="math inline">\(\alpha_i\)</span> comme :</p>
<p><span class="math display">\[\chi^2=\sum{\frac{(a_i - \alpha_i)^2}{\alpha_i}}\]</span></p>
<p>Il y a un terme par cellule du tableau de contingence (que nous appelerons les <em>contributions</em> au Chi<sup>2</sup>), et par ailleurs, sous l’hypothèse nulle d’indépendance des variables, les <span class="math inline">\(\alpha_i\)</span> sont connus et dépendent uniquement des sommes des lignes et des colonnes du tableau. En effet, nous avons :</p>
<p><span class="math display">\[\alpha_i = \frac{\textrm{total ligne} . \textrm{total colonne}}{\textrm{total général}}\]</span></p>
<p>Donc, lors du calcul du Chi<sup>2</sup>, nous passons par une étape de transformation du tableau de contingence à double entrée où nous substituons les effectifs observés (des entiers, donc du quantitatif discret) par les contributions respectives au Chi<sup>2</sup>. Or ces contributions sont des valeurs réelles (continues) nulles ou positives. Nous obtenons donc un tableau contenant des <em>valeurs numériques continues</em> qui peut être traité par une ACP classique.</p>
<p>L’ACP va reprojetter les lignes du tableau (qui, rappelons-le, sont les différents niveaux d’une des deux variables qualitative étudiée) dans un espace réduit. Dans ce contexte, le graphique représentant les variables n’a pas grand intérêt, puique ces variables sont en réalité fictives, ou si vous préférez, “bricolées”. Par contre, la position des individus les uns par rapport aux autres, et par rapport au centre d’inertie du graphique a une signification importante et interprétable.</p>
<p>Enfin, comme il n’y a aucune raison <em>a priori</em> d’utiliser une variable en ligne et l’autre en colonne, nous pouvons également transposer la table de contingence (les lignes deviennent les colonnes et <em>vice versa</em>). Si nous réalisons une nouvelle ACP sur ce tableau transposé, nous allons reprojetter les niveaux de l’<em>autre</em> variable qualitative sur un autre espace réduit.</p>
<p>Si nous prenons le même nombre de composantes principales des deux côtés, nous aurons la même part de variance reprise dans les deux projections. De plus, nous pouvons <em>superposer</em> les deux représentations en faisant coïncider les deux centres d’inertie en {0, 0}. La difficulté, comme pour tout biplot, est d’arriver à mettre à l’échelle les points d’une représentation par rapport à ceux de l’autre. Cette mise à l’échelle permet d’interpréter les points de couleurs différentes conjointement : des points proches sur le biplot dénotent des <em>correspondances</em> entre les niveaux respectifs des deux variables étudiées, d’où le nom de la méthode, analyse factorielle des <em>correspondances</em>.</p>
<p>Au final, l’AFC apparait donc comme une variante de l’ACP qui utilise la distance du Chi<sup>2</sup> à la place de la distance euclidienne dans l’ACP classique, et qui reflète la symétrie du tableau de contingence (lignes/colonnes <em>versus</em> colonnes/lignes). Il en résulte la possiblité d’analyser ainsi des données qualitatives pour lesquelles la distance et la statistique du Chi<sup>2</sup> ont précisément été inventées.</p>
<div id="pour-en-savoir-plus-5" class="section level5 unnumbered">
<h5>Pour en savoir plus</h5>
<ul>
<li><p>Une courte introduction de l’AFC en <a href="https://www.youtube.com/watch?v=tEc5cmlQVdI">vidéo</a> avec résolution d’un exemple volontairement simpliste pour faire comprendre la signification du graphique obtenu et la façon de l’interpréter.</p></li>
<li><p>Une <a href="http://www.sthda.com/french/articles/38-methodes-des-composantes-principales-dans-r-guide-pratique/74-afc-analyse-factorielle-des-correspondances-avec-r-l-essentiel/">autre explication</a> qui utilise les packages <code>FactoMineR</code> et <code>factoextra</code> et qui va plus loin dans les concepts (notamment la qualité de la représentation des points via leur “cos<sup>2</sup>”, les différents types de biplots, et l’ajout de données supplémentaires).</p></li>
</ul>
</div>
<div id="a-vous-de-jouer-20" class="section level5 unnumbered">
<h5>A vous de jouer !</h5>
<ul>
<li>Réalisez le début du projet spécifique lié au module 7. Ce module couvre la matière entière du module 7.</li>
</ul>

<div class="bdd">
<p><strong>Le lien pour réaliser ce projet se trouve en début du module 7</strong></p>
<em>Ce projet doit être terminé à la fin de ce module</em>
</div>

<ul>
<li>Complétez votre projet sur le transect entre Nice et Calvi débuté lors du module 5. Lisez attentivement le README (Ce dernier a été mis à jour).</li>
</ul>

<div class="bdd">
<p>Complétez votre projet. Lisez attentivement le README.</p>
<p>La dernière version du README est disponible via le lien suivant :</p>
<ul>
<li><a href="https://github.com/BioDataScience-Course/spatial_distribution_zooplankton_ligurian_sea/blob/master/README.md" class="uri">https://github.com/BioDataScience-Course/spatial_distribution_zooplankton_ligurian_sea/blob/master/README.md</a></li>
</ul>
<em>Le README est un rappel des consignes, il ne s’agit aucunement du lien pour débuter le travail</em>
</div>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="20">
<li id="fn20"><p>Attention : les valeurs sur les axes ne sont pas à interpréter quantitativement. Elles ne portent pas une information utile ici.<a href="analyse-factorielle-des-correspondances.html#fnref20" class="footnote-back">↩</a></p></li>
</ol>
</div>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://sddb.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="analyse-en-composantes-principales.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="acces-aux-bases-de-donnees.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/BioDataScience-Course/sdd-umons2-2019/edit/master/07-acp-afc.Rmd",
"text": "Editer"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
